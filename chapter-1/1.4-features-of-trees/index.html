
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../1.3-visualization/">
      
      
        <link rel="next" href="../1.5-code-node-class/">
      
      <link rel="icon" href="/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.11">
    
    
      
        <title>1.4 - Tree data structure - Phylogenetic Data Science (IN DEVELOPMENT)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-HV34HZZD5N"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-HV34HZZD5N",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-HV34HZZD5N",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#trees-as-data-objects" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Phylogenetic Data Science (IN DEVELOPMENT)" class="md-header__button md-logo" aria-label="Phylogenetic Data Science (IN DEVELOPMENT)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phylogenetic Data Science (IN DEVELOPMENT)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1.4 - Tree data structure
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/eaton-lab/phylogenetic-data-science" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Phylogenetic Data Science (IN DEVELOPMENT)" class="md-nav__button md-logo" aria-label="Phylogenetic Data Science (IN DEVELOPMENT)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Phylogenetic Data Science (IN DEVELOPMENT)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eaton-lab/phylogenetic-data-science" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        About/Ethos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation/Software
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../course/" class="md-nav__link">
        Columbia course
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          0 - Coding Bootcamp
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          0 - Coding Bootcamp
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/getting-started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.0-installation-conda/" class="md-nav__link">
        0.0 - Installation (conda)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.1-jupyter-and-binder/" class="md-nav__link">
        0.1 - Python Jupyter/Binder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.2-python-types/" class="md-nav__link">
        0.2 - Python types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.3-python-funcs/" class="md-nav__link">
        0.3 - Python functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.4-python-classes/" class="md-nav__link">
        0.4 - Python classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.5-python-style/" class="md-nav__link">
        0.5 - Python style
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          1 - Trees as data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          1 - Trees as data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.1-introduction/" class="md-nav__link">
        x.1 - Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.2-tree-thinking/" class="md-nav__link">
        x.2 - Tree Thinking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.3-visualization/" class="md-nav__link">
        x.3 - Visualization
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1.4 - Tree data structure
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        1.4 - Tree data structure
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-features-of-a-tree" class="md-nav__link">
    The Features of a Tree
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-terminology" class="md-nav__link">
    Basic Terminology
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mathematical-terminology" class="md-nav__link">
    Mathematical Terminology
  </a>
  
    <nav class="md-nav" aria-label="Mathematical Terminology">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nodes" class="md-nav__link">
    Nodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edges" class="md-nav__link">
    Edges
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coding-trees" class="md-nav__link">
    Coding Trees
  </a>
  
    <nav class="md-nav" aria-label="Coding Trees">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tabular-data-structure" class="md-nav__link">
    Tabular data structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tree-data-structure" class="md-nav__link">
    Tree Data Structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.5-code-node-class/" class="md-nav__link">
        1.5 - Code - Node class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.6-code-tree-traversal/" class="md-nav__link">
        1.6 - Code - Tree traversal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.7-code-tree-class/" class="md-nav__link">
        1.7 - Code - Tree class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.6-exercises.md" class="md-nav__link">
        x.7 - Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          2 - Evolutionary models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          2 - Evolutionary models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.0-modeling-evolution/" class="md-nav__link">
        2.0 - Modeling evolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.1-idealized-population/" class="md-nav__link">
        2.1 - Idealized population
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.2-wright-fisher/" class="md-nav__link">
        2.2 - Wright-Fisher Process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.3-coalescent/" class="md-nav__link">
        2.3 - The Coalescent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.4-coalescent-simulation/" class="md-nav__link">
        2.4 - Coalescent simulation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.x-exercises/" class="md-nav__link">
        2.x - Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          3 - Mutation Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          3 - Mutation Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/3.x-DNA-Markov.md" class="md-nav__link">
        3.0 - Modeling Evolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        3.x - Probabilistic and Generative Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/3.2-markov-models/" class="md-nav__link">
        3.2 - Markov models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3.x-other-models.md" class="md-nav__link">
        3.x - Other models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-reading-list.md" class="md-nav__link">
        Reading and Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          4 - Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          4 - Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.1-data-formats.md" class="md-nav__link">
        x.1 - data formats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.2-strings-and-matrices.md" class="md-nav__link">
        x.2 - strings, tables, and matrices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.x-simulating-traits.md" class="md-nav__link">
        x.x - Code - simulating data/traits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.x-sequence-alignment.md" class="md-nav__link">
        x.x - Code - sequence alignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.x-converting-file-formats.md" class="md-nav__link">
        x.x - Code - converting file formats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../read, write, parse, find, and clean phylip, fasta, fastq, and vcf data." class="md-nav__link">
        Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          5 - Phylogenetic Inference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          5 - Phylogenetic Inference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.0 - introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.1 - history
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.2 - choosing a method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.3 - ..." class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.4 - ..." class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          6 - Inference (Parsimony)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          6 - Inference (Parsimony)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/6.0-fitch-parsimony/" class="md-nav__link">
        6.0 - Fitch Parsimony
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/6.1-fitch-multiple-traits/" class="md-nav__link">
        6.1 - Character matrices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        6.2 - Sankoff Parsimony
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          7 - Inference (Distance-based)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          7 - Inference (Distance-based)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.0-introduction/" class="md-nav__link">
        7.0 - Distance based trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.1-least-squares/" class="md-nav__link">
        7.1 - Code - Least-squares
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.2-upgma/" class="md-nav__link">
        7.2 - Code - UPGMA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.3-neighbor-joining/" class="md-nav__link">
        7.3 - Code - Neighbor Joining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.4-applied/" class="md-nav__link">
        7.4 - Applied examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.5-new-applications/" class="md-nav__link">
        7.5 - New Applications
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
      
      
      
        <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
          8 - Inference (Likelihood)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          8 - Inference (Likelihood)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.0 - Maximum Likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.1 - Genealogies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.2 - Sequences
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.3 - Inferring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Reading and Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
      
      
      
        <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
          9 - Multispecies Coalescent
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          9 - Multispecies Coalescent
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.0-intro.md" class="md-nav__link">
        9.0 - Species trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.1-likelihood.md" class="md-nav__link">
        9.1 - Coalescent likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.2-genealogical.md" class="md-nav__link">
        9.2 - Genealogical thinking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.2-genetics.md" class="md-nav__link">
        9.3 - Genetic thinking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.3-MSC.md" class="md-nav__link">
        9.4 - MSC likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Reading and Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#the-features-of-a-tree" class="md-nav__link">
    The Features of a Tree
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-terminology" class="md-nav__link">
    Basic Terminology
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mathematical-terminology" class="md-nav__link">
    Mathematical Terminology
  </a>
  
    <nav class="md-nav" aria-label="Mathematical Terminology">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nodes" class="md-nav__link">
    Nodes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#edges" class="md-nav__link">
    Edges
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coding-trees" class="md-nav__link">
    Coding Trees
  </a>
  
    <nav class="md-nav" aria-label="Coding Trees">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tabular-data-structure" class="md-nav__link">
    Tabular data structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tree-data-structure" class="md-nav__link">
    Tree Data Structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



<h1 id="trees-as-data-objects">Trees as data objects<a class="headerlink" href="#trees-as-data-objects" title="Permanent link">&para;</a></h1>
<h2 id="the-features-of-a-tree">The Features of a Tree<a class="headerlink" href="#the-features-of-a-tree" title="Permanent link">&para;</a></h2>
<p>A tree can be represented in a variety of ways. Its representation can be
visual, as we have seen already in drawings/plots of trees generated with 
graphical tools, but trees can also be represented as a data structure -- 
an object for storing and retrieving information. In fact, trees are widely
used throughout computer science as an efficient data structure for working
with hierarchically structured data. Because the evolutionary process 
inherently gives rise to hierarchically structured information in the form
of ancestry, trees are also widely used in biology both as a 
hypothesis/model, and as a data structure for studying and analyzing 
evolutionary data. How can we create a tree data structure, and 
what does that even mean? Let's walk through it.</p>
<p>A goal of representing a tree as a data structure is to be able to extract
information from the tree. To understand this, its helpful to first think
about what types of information <em>can</em> or <em>must</em> exist in a tree structureobject. 
Look at the tree drawing below to try to identify its core features.</p>
<details class="example">
<summary>Example code to create simple tree figure</summary>
<div class="highlight"><pre><span></span><code><span class="c1"># generate a random 8 tip ultrametric tree</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">toytree</span><span class="o">.</span><span class="n">rtree</span><span class="o">.</span><span class="n">unittree</span><span class="p">(</span><span class="n">ntips</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># draw facing downw with node index labels shown</span>
<span class="n">tree</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">node_labels</span><span class="o">=</span><span class="s2">&quot;idx&quot;</span><span class="p">,</span> <span class="n">node_sizes</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">node_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
</details>
<figure>
<p><img _="," alt="Heatmap image" loading="lazy" src="../notebooks/fig1.svg" width="400" />
<br />
<!-- <figcaption>An example phylogenetic tree drawing.</figcaption> --></p>
</figure>
<h2 id="basic-terminology">Basic Terminology<a class="headerlink" href="#basic-terminology" title="Permanent link">&para;</a></h2>
<p>There are a number of terms that are used to refer to the parts of a tree, 
and this often varies depending on the field of study in which trees are being
used, such as mathematics, computer science, or biology. For example, the
circles in the figure above are usually referred to as <strong>nodes</strong> or 
<strong>vertices</strong>, and the lines connecting these are usually referred to as 
<strong>edges</strong> or <strong>branches</strong>. These terms for each are often used interchangeably. 
This terminology is also used to describe <em>graphs</em>, which are a similar
data structure widely used in mathematics, and increasingly in biology 
as well. </p>
<p>The most fundamental features of a tree are the nodes and edges.
But, you may have also identified additional information in the tree drawing,
such as the lengths of edges; the labels of nodes; whether or 
not each node is a tip or root node (i.e., the number of edges connected 
to each node), and perhaps other information as well. Given that a tree
composes a somewhat heterogenous collection of information, it begs the
question: what is the best way to represent a tree as a data structure? 
In other words, how can we most conveniently access its information for the
purpose of scientific analyses?</p>
<h2 id="mathematical-terminology">Mathematical Terminology<a class="headerlink" href="#mathematical-terminology" title="Permanent link">&para;</a></h2>
<p>Let's start by describing a tree in mathematical terms, where it is considered
a special type of graph called a <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph"><em>directed acyclic graph (DAG)</em></a>. This 
simply means it is a graph where edges point from one vertex to another, 
and cannot form a closed loop (the descendant of a node cannot also be its own ancestor). This property of DAGs makes them well suited for representing 
hierarchical data which, by definition, has the same non-looping property. 
(By contrast, a cyclic graph could be used to represent a network of 
roads, or social connections, where loops in the graph are possible.)</p>
<p>In a more syntactic form, a graph (<strong>G</strong>) can be defined by a set of 
vertices (<strong>V</strong>) and edges (<strong>E</strong>). We can refer to the vertices by a set 
of unique labels assigned to each one, e.g., <code>V = {A,B,C,D,E,F}</code>. 
Each edge is defined by a pair of vertices. In the case of a DAG, these
are treated as <em>directed</em> edges, pointing from the first to the second 
vertex: <code>E = {(A,B),(A,C),(C,D),(C,E),(C,F)}</code>. 
This is a common way in which a tree or graph might be described in a 
mathematical paper. It is a statement, in this case, that six vertices 
exist, and there are five edges connecting them. 
The exact syntax that might be used in a paper, in terms of using 
curly brackets and/or parentheses, may vary, but usually curly brackets are 
used to represent sets of unique items (just like the <code>set</code> object type in 
Python). In fact, from looking at this mathematical description you may 
already have started to think of it as Python code, and this is because it
is very similar. So, let's also write the same thing in Python, here 
using strings as labels for the unique vertices.</p>
<div class="highlight"><span class="filename">create sets of vertices and edges</span><pre><span></span><code><span class="n">V</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">}</span>
<span class="n">E</span> <span class="o">=</span> <span class="p">{(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;D&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;E&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">)}</span>
</code></pre></div>
<h3 id="nodes">Nodes<a class="headerlink" href="#nodes" title="Permanent link">&para;</a></h3>
<p>Nodes can be referred to by some type of unique label, such as a name or 
number. An important feature of a Node is its <em>degree</em>, the number of edges 
that connect to it. For example, in <strong>G</strong> from above, the node A has degree=2,
whereas the node C has degree=4. This can easily be computed for each vertex by 
iterating over each item in the edges set and counting how many edges each 
Node is a member of.</p>
<details class="example">
<summary>print the degree of each vertex</summary>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">V</span><span class="p">):</span>
    <span class="n">degree</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">E</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">:</span>
            <span class="n">degree</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vertex </span><span class="si">{</span><span class="n">vertex</span><span class="si">}</span><span class="s2"> has degree=</span><span class="si">{</span><span class="n">degree</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<div class="highlight"><pre><span></span><code>vertex A has degree=2
vertex B has degree=1
vertex C has degree=4
vertex D has degree=1
vertex E has degree=1
vertex F has degree=1
</code></pre></div>
<p>In DAGs, because the edges are <em>directed</em>, the edge <code>(A,B)</code> has a different 
meaning than the edge <code>(B,A)</code>; only one or the other can exist. Thus, we 
can also refer to the <em>in-degree</em> and <em>out-degree</em> of each Node as the 
number of edges pointing <em>to</em> or <em>from</em> each node, respectively. </p>
<details class="example">
<summary>print the directed degree of each vertex</summary>
<div class="highlight"><pre><span></span><code><span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">V</span><span class="p">):</span>
    <span class="n">in_degree</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">E</span> <span class="k">if</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">out_degree</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">E</span> <span class="k">if</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;vertex </span><span class="si">{</span><span class="n">vertex</span><span class="si">}</span><span class="s2"> has in_degree=</span><span class="si">{</span><span class="n">in_degree</span><span class="si">}</span><span class="s2">, out_degree=</span><span class="si">{</span><span class="n">out_degree</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<div class="highlight"><pre><span></span><code>vertex A has in_degree=0; out_degree=2
vertex B has in_degree=1; out_degree=0
vertex C has in_degree=1; out_degree=3
vertex D has in_degree=1; out_degree=0
vertex E has in_degree=1; out_degree=0
vertex F has in_degree=1; out_degree=0
</code></pre></div>
<p>This leads to a simple way of distinguishing several different types of 
Nodes that are associated with different meanings in phylogenetics. For 
example, Nodes that represent extant samples in a phylogenetic tree
have a special meaning. These are the actual observations. All internal nodes,
by contrast, are theoretical constructs representing inferred ancestors, and
whose properties are a consequence of the type of inference model that is 
used to infer the tree. The extant samples in a tree are referred
to as <strong>tip nodes</strong>, or <strong>leaves</strong>. In terms of their degree, tip nodes 
always have <code>in_degree=1</code>, and <code>out_degree=0</code>. You can see that our graph <strong>G</strong>
has four tips nodes: B, D, E and F. By contrast, <strong>internal nodes</strong> of a 
tree will always have <code>in_degree=1</code> and <code>out_degree&gt;=2</code>. As an example, 
vertex C in <strong>G</strong> is an internal node that has one ancestor and three 
descendants. </p>
<p>A <strong>bifurcating</strong> phylogenetic tree is a tree in which every
internal node has exactly two descendants, i.e., <code>out_degree=2</code>. In our 
example, the tree is non-bifurcating, because vertex C represents a 
<strong>polytomy</strong>, containing &gt;2 descendants. Finally, the <strong>root</strong> node is defined
by having an <code>in_degree=0</code>, since there is no information about its ancestor. 
The <em>degrees</em> of Nodes in a graph constrain the types of structures that it
can represent. As an example, a node in a phylogenetic tree <em>cannot</em> have 
an <code>in_degree&gt;1</code>, meaning that a node would have more than one ancestor in 
the tree. It is possible for a node to have &gt;=2 ancestors in a 
in a related data structure called a <em>phylogenetic network</em>, which is 
mathematically similar to a phylogenetic tree, but with different constraints. </p>
<!-- What are the minimal types of Nodes that must exist in a phylogenetic tree? -->

<h3 id="edges">Edges<a class="headerlink" href="#edges" title="Permanent link">&para;</a></h3>
<p>As we saw above, the edge set is the core information defining the 
relationships among vertices, including their <em>degree</em>. 
Although a vertex can vary in the number of 
connections it forms with other vertices (its <em>degree</em>), <em>edges</em> are 
simpler: they always connect just one vertex to another, no more or less. 
In this way, edges can be represented simply as a collection of the 
start and end vertices of each edge, as in the set <strong>E</strong> from above. 
As we will see later, however, we are often interested in storing 
additional information about edges, such as their length, which can be 
used as a weight, or confidence score, and this information is
usually stored separately from the edge set. </p>
<h2 id="coding-trees">Coding Trees<a class="headerlink" href="#coding-trees" title="Permanent link">&para;</a></h2>
<p>Different approaches to representing trees as data structures have 
different challenges for storing and working with information about 
nodes, edges, and their metadata. Below are the two most common approaches
for representing trees/graphs: tables and tree structures. </p>
<h3 id="tabular-data-structure">Tabular data structure<a class="headerlink" href="#tabular-data-structure" title="Permanent link">&para;</a></h3>
<p>Storing trees as a table has potential benefits over alternative approaches.
For one, a table is very memory efficient. If you have a tree with 1 million
Nodes this could be stored in the space required for storing two columns
of 1 million integers. This fact is taken advantage of in software tools
like <code>tskit</code>, which is used to study collections of genealogical trees 
across entire genomes, which can include millions of trees of large 
size. This software is particularly designed for studying genealogies that
represent <em>linked trees</em>, a specific problem in which many trees share 
parts (nodes) that are identical. For example, this is common among 
genealogies from regions of the genome that are in linkage disequilibrium.
In this context, a table can store the redundant information among linked 
trees very efficiently. We will learn more about this library and its data 
objects in a later chapter.</p>
<p>While tables can be efficient for storing and studying fixed trees, they 
are not very efficient when the tree structure needs to be mutable, i.e.,
when we plan to modify the tree at various times by adding and/or 
removing Nodes from the tree. Depending on where the new Nodes are placed, 
we would need to increment the labels of each Node to update which ones are 
connected to which. Similarly, if we wanted to re-root the tree, or change 
other attributes such as the edge lengths, many changes to the table would
need to be made. </p>
<details class="example">
<summary>get edge table from ToyTree</summary>
<div class="highlight"><pre><span></span><code><span class="n">tree</span> <span class="o">=</span> <span class="n">toytree</span><span class="o">.</span><span class="n">rtree</span><span class="o">.</span><span class="n">unittree</span><span class="p">(</span><span class="n">ntips</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">etable</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">get_edges</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">etable</span><span class="p">)</span>
</code></pre></div>
</details>
<p><img _="," align="left" alt="tree-with-labels" src="../notebooks/fig2.svg" width="300" /></p>
<div class="highlight"><pre><span></span><code>    child  parent
0       0       8
1       1       8
2       2       9
3       3       9
4       4      11
5       5      11
6       6      13
7       7      13
8       8      10
9       9      10
10     10      12
11     11      12
12     12      14
13     13      14
</code></pre></div>
<p><br>
For example, say we wanted to find the names of all descendants of internal 
Node 10 in the tree above. Using a table this would require multiple lookups
in the table to ask which nodes are directly descended from Node 10, and then 
which are descended from those descendants. In Python, a table would likely 
be stored as an array, ndarray, or DataFrame, where such lookups can be fast 
in absolute terms, but would require multiple iterations over the table, 
making it slow relative to some alternative approaches.</p>
<h3 id="tree-data-structure">Tree Data Structure<a class="headerlink" href="#tree-data-structure" title="Permanent link">&para;</a></h3>
<p>A common way to store hierarchical data is to use a Tree data structure. 
This can be created in any object-oriented programming (OOP) language where
arbitrary class objects can be created in memory, and <em>references/pointers</em> 
among these objects can be created. This approach is particularly common 
in languages like C, Java, and Python. Each Node in a tree can be represented
by an object in memory (e.g., a Python class instance), and Edges are 
represented simply by references, stored as an attribute to each Node, of 
which other Nodes it is directly connected to.</p>
<p>This design has a number of advantages. First, it has only a slightly larger
memory footprint than using tables, while allowing much greater flexibility
for storing information in a way that preserves hierarchical relationships. 
Second, it naturally allows for the use of <strong>traversal</strong> methods, which are
used to trace a path through the connections among Nodes, from one to the 
next, in a particular order. This process, termed a <code>tree traversal</code>, turns
out to be a very common algorithm used throughout computer science. 
Consequently, the development of tree data structures has been well studied.
For example, the file system on your computer represents a tree data 
structure, where folders are nested within folders nested within folders. 
We can even write the structure of folder names in newick
format to draw it as a tree, like in the example below:</p>
<details class="example">
<summary>Example: parse file system as a newick tree and draw</summary>
<div class="highlight"><pre><span></span><code><span class="n">mock_file_system</span> <span class="o">=</span> <span class="s2">&quot;((((...)Docs,(...)Pics,(...)Music)deren)home, (...)usr,(...)bin,(...)tmp,(...)dev)/;&quot;</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">toytree</span><span class="o">.</span><span class="n">tree</span><span class="p">(</span><span class="n">mock_file_system</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
    <span class="n">node_sizes</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">node_mask</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">node_colors</span><span class="o">=</span><span class="s2">&quot;lightgrey&quot;</span><span class="p">,</span>
    <span class="n">node_markers</span><span class="o">=</span><span class="s2">&quot;r2x1&quot;</span><span class="p">,</span>
    <span class="n">node_style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;stroke-width&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="n">node_labels</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="n">node_labels_style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;font-size&quot;</span><span class="p">:</span> <span class="s2">&quot;14px&quot;</span><span class="p">},</span>
    <span class="n">tip_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
    <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span>
<span class="p">);</span>
</code></pre></div>
</details>
<figure>
<p><img _="," alt="tree-file_system" loading="lazy" src="../notebooks/fig3.svg" width="400" />  <br />
<br />
<!-- ![Heatmap image](./notebooks/fig1.svg){width="400", loading=lazy} --></p>
<!-- <figcaption>An example phylogenetic tree drawing.</figcaption> -->
</figure>
<p>File browsers and other computer programs <code>traverse</code> the file system 
frequently, for example when looking for files of a certain name or type.
This design allows such algorithms to fetch information very quickly by 
partitioning information into nested hierarchies, e.g., only looking in 
locations <em>descended</em> from a particular location, rather than searching 
the entire file system, which would be much slower.</p>
<p>The traversal process turns out to be highly useful for calculating 
statistics on hierarchical data as well, where information can often be
calculated on subsets at a time without needing to load all objects at once.
For example, consider the problem of calculating the size of all files on your
filesystem. Writing a function to do this may at first seem daunting. But,
if you think of the filesystem as a tree that can be traversed then the 
problem is greatly simplified. You would simply need to write a function that
performs the same operation on every <em>node</em> (folder) of the file system. 
For example, working from the tips towards the root, this would be to sum the
size of files in a folder, plus the sizes of any folders directly descended
from it. If applied to folders in the order of a traversal that will first
visit the tip nodes, then their ancestors, and so on so that it visits the
root last, then this will sum to the size of all files in the system.
In the next chapter we will implement traversal algorithms firsthand to 
better understand this process and how it can make calculating statistics
on trees very simple and elegant.</p>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "search.highlight", "search.suggest", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6df46069.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>