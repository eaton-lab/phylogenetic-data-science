
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../1.5-code-node-class/">
      
      
        <link rel="next" href="../1.7-code-tree-class/">
      
      <link rel="icon" href="/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.11">
    
    
      
        <title>1.6 - Code - Tree traversal - Phylogenetic Data Science (IN DEVELOPMENT)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-HV34HZZD5N"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-HV34HZZD5N",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-HV34HZZD5N",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#in-development" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Phylogenetic Data Science (IN DEVELOPMENT)" class="md-header__button md-logo" aria-label="Phylogenetic Data Science (IN DEVELOPMENT)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Phylogenetic Data Science (IN DEVELOPMENT)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              1.6 - Code - Tree traversal
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/eaton-lab/phylogenetic-data-science" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Phylogenetic Data Science (IN DEVELOPMENT)" class="md-nav__button md-logo" aria-label="Phylogenetic Data Science (IN DEVELOPMENT)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Phylogenetic Data Science (IN DEVELOPMENT)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/eaton-lab/phylogenetic-data-science" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        About/Ethos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Installation/Software
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../course/" class="md-nav__link">
        Columbia course
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          0 - Coding Bootcamp
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          0 - Coding Bootcamp
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/getting-started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.0-installation-conda/" class="md-nav__link">
        0.0 - Installation (conda)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.1-jupyter-and-binder/" class="md-nav__link">
        0.1 - Python Jupyter/Binder
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.2-python-types/" class="md-nav__link">
        0.2 - Python types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.3-python-funcs/" class="md-nav__link">
        0.3 - Python functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.4-python-classes/" class="md-nav__link">
        0.4 - Python classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../bootcamp/0.5-python-style/" class="md-nav__link">
        0.5 - Python style
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          1 - Trees as data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          1 - Trees as data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.1-introduction/" class="md-nav__link">
        x.1 - Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.2-tree-thinking/" class="md-nav__link">
        x.2 - Tree Thinking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.3-visualization/" class="md-nav__link">
        x.3 - Visualization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.4-features-of-trees/" class="md-nav__link">
        1.4 - Tree data structure
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.5-code-node-class/" class="md-nav__link">
        1.5 - Code - Node class
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          1.6 - Code - Tree traversal
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        1.6 - Code - Tree traversal
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    Learning objectives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-goals" class="md-nav__link">
    Chapter goals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-class" class="md-nav__link">
    Node class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-trees" class="md-nav__link">
    Generating Trees
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coding-traversal-algorithms" class="md-nav__link">
    Coding traversal algorithms
  </a>
  
    <nav class="md-nav" aria-label="Coding traversal algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traversal-by-recursion" class="md-nav__link">
    Traversal by recursion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traversal-by-iteration" class="md-nav__link">
    Traversal by iteration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traversal-strategies" class="md-nav__link">
    Traversal strategies
  </a>
  
    <nav class="md-nav" aria-label="Traversal strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#levelorder-traversal" class="md-nav__link">
    levelorder traversal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preorder-traversal" class="md-nav__link">
    preorder traversal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postorder-traversal" class="md-nav__link">
    postorder traversal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idxorder-traversal" class="md-nav__link">
    idxorder traversal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coding-node-traversals" class="md-nav__link">
    Coding Node Traversals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-traversals" class="md-nav__link">
    Using Traversals
  </a>
  
    <nav class="md-nav" aria-label="Using Traversals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leaf-and-name-retrieval" class="md-nav__link">
    Leaf and Name Retrieval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-relationships" class="md-nav__link">
    Node Relationships
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preorder-usage" class="md-nav__link">
    Preorder usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postorder-usage" class="md-nav__link">
    Postorder usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.7-code-tree-class/" class="md-nav__link">
        1.7 - Code - Tree class
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.6-exercises.md" class="md-nav__link">
        x.7 - Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          2 - Evolutionary models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          2 - Evolutionary models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.0-modeling-evolution/" class="md-nav__link">
        2.0 - Modeling evolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.1-idealized-population/" class="md-nav__link">
        2.1 - Idealized population
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.2-wright-fisher/" class="md-nav__link">
        2.2 - Wright-Fisher Process
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.3-coalescent/" class="md-nav__link">
        2.3 - The Coalescent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.4-coalescent-simulation/" class="md-nav__link">
        2.4 - Coalescent simulation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/2.x-exercises/" class="md-nav__link">
        2.x - Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          3 - Mutation Models
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          3 - Mutation Models
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/3.x-DNA-Markov.md" class="md-nav__link">
        3.0 - Modeling Evolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        3.x - Probabilistic and Generative Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/3.2-markov-models/" class="md-nav__link">
        3.2 - Markov models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3.x-other-models.md" class="md-nav__link">
        3.x - Other models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-reading-list.md" class="md-nav__link">
        Reading and Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          4 - Data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          4 - Data
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.1-data-formats.md" class="md-nav__link">
        x.1 - data formats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4.2-strings-and-matrices.md" class="md-nav__link">
        x.2 - strings, tables, and matrices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.x-simulating-traits.md" class="md-nav__link">
        x.x - Code - simulating data/traits
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.x-sequence-alignment.md" class="md-nav__link">
        x.x - Code - sequence alignment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.x-converting-file-formats.md" class="md-nav__link">
        x.x - Code - converting file formats
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../read, write, parse, find, and clean phylip, fasta, fastq, and vcf data." class="md-nav__link">
        Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          5 - Phylogenetic Inference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          5 - Phylogenetic Inference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.0 - introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.1 - history
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.2 - choosing a method
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.3 - ..." class="md-nav__link">
        None
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../x.4 - ..." class="md-nav__link">
        None
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          6 - Inference (Parsimony)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          6 - Inference (Parsimony)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/6.0-fitch-parsimony/" class="md-nav__link">
        6.0 - Fitch Parsimony
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/6.1-fitch-multiple-traits/" class="md-nav__link">
        6.1 - Character matrices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        6.2 - Sankoff Parsimony
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          7 - Inference (Distance-based)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          7 - Inference (Distance-based)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.0-introduction/" class="md-nav__link">
        7.0 - Distance based trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.1-least-squares/" class="md-nav__link">
        7.1 - Code - Least-squares
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.2-upgma/" class="md-nav__link">
        7.2 - Code - UPGMA
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.3-neighbor-joining/" class="md-nav__link">
        7.3 - Code - Neighbor Joining
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.4-applied/" class="md-nav__link">
        7.4 - Applied examples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/7.5-new-applications/" class="md-nav__link">
        7.5 - New Applications
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
      
      
      
        <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
          8 - Inference (Likelihood)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          8 - Inference (Likelihood)
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.0 - Maximum Likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.1 - Genealogies
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.2 - Sequences
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        x.3 - Inferring
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Reading and Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
      
      
      
        <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
          9 - Multispecies Coalescent
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_13">
          <span class="md-nav__icon md-icon"></span>
          9 - Multispecies Coalescent
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.0-intro.md" class="md-nav__link">
        9.0 - Species trees
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.1-likelihood.md" class="md-nav__link">
        9.1 - Coalescent likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.2-genealogical.md" class="md-nav__link">
        9.2 - Genealogical thinking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.2-genetics.md" class="md-nav__link">
        9.3 - Genetic thinking
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/9.3-MSC.md" class="md-nav__link">
        9.4 - MSC likelihood
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Reading and Exercises
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#learning-objectives" class="md-nav__link">
    Learning objectives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-goals" class="md-nav__link">
    Chapter goals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#node-class" class="md-nav__link">
    Node class
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generating-trees" class="md-nav__link">
    Generating Trees
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coding-traversal-algorithms" class="md-nav__link">
    Coding traversal algorithms
  </a>
  
    <nav class="md-nav" aria-label="Coding traversal algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#traversal-by-recursion" class="md-nav__link">
    Traversal by recursion
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#traversal-by-iteration" class="md-nav__link">
    Traversal by iteration
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#traversal-strategies" class="md-nav__link">
    Traversal strategies
  </a>
  
    <nav class="md-nav" aria-label="Traversal strategies">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#levelorder-traversal" class="md-nav__link">
    levelorder traversal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preorder-traversal" class="md-nav__link">
    preorder traversal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postorder-traversal" class="md-nav__link">
    postorder traversal
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#idxorder-traversal" class="md-nav__link">
    idxorder traversal
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#coding-node-traversals" class="md-nav__link">
    Coding Node Traversals
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#using-traversals" class="md-nav__link">
    Using Traversals
  </a>
  
    <nav class="md-nav" aria-label="Using Traversals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#leaf-and-name-retrieval" class="md-nav__link">
    Leaf and Name Retrieval
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#node-relationships" class="md-nav__link">
    Node Relationships
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preorder-usage" class="md-nav__link">
    Preorder usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#postorder-usage" class="md-nav__link">
    Postorder usage
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    Summary
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    References
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  



<!-- 
:material-star: *Follow along in a jupyter notebook on binder:*
[:material-notebook: Node-class.ipynb](https://mybinder.org/v2/gh/eaton-lab/phylogenetic-data-science/HEAD?filepath=docs%2Fchapter-1%2Fnotebooks%2Fcode-tree-traversal.ipynb) -->

<h1 id="in-development">IN DEVELOPMENT<a class="headerlink" href="#in-development" title="Permanent link">&para;</a></h1>
<h2 id="learning-objectives">Learning objectives<a class="headerlink" href="#learning-objectives" title="Permanent link">&para;</a></h2>
<p>The goal of this chapter is to introduce the concept of tree traversals.
By the end of this chapter you will:</p>
<ol>
<li>Understand how traversal over connected Nodes is useful for working with trees.</li>
<li>Be familiar with different tree traversal algorithms.</li>
<li>Practice writing tree traversal functions using iterators and recursion.</li>
</ol>
<h2 id="chapter-goals">Chapter goals<a class="headerlink" href="#chapter-goals" title="Permanent link">&para;</a></h2>
<p>A key feature of tree data structures is the process of traversal, by which each
Node is visited in some determined order. Traversal algorithms make it
possible to calculate information on trees fast and efficiently, typically
by performing calculations on parts of the tree which can be used for later
calculations. Examples of this include <em>Felsenstein's pruning algorithm</em>,
which we will cover later, as an efficient traversal algorithm for calculating
parsimony or likelihood scores on trees (citation). Here we will first cover
several more simple examples, showing how different traversal algorithms
visit Nodes in different orders, and why this is useful for different types
of operations.</p>
<h2 id="node-class">Node class<a class="headerlink" href="#node-class" title="Permanent link">&para;</a></h2>
<p>We will reuse the simple Node class object that we developed in the last
chapter. As a reminder, an instance of this class represents a single Node,
but by creating multiple Nodes that include references to each other, the
collection of Nodes can represent a tree data structure.</p>
<details class="example">
<summary>Node class definition</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span>

<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A Node instance that can connect with other Nodes to form a Tree.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        A name string associated with a Node when printed or visualized.</span>
<span class="sd">    dist: float</span>
<span class="sd">        A float value as the distance between this Node and its parent (up)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    children: Tuple</span>
<span class="sd">        A tuple of Node instances that are descended from this Node.</span>
<span class="sd">    up: Node or None</span>
<span class="sd">        A Node that is ancestral to this Node, or None if this Node is root.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; node = Node(&quot;A&quot;)</span>
<span class="sd">    &gt;&gt;&gt; node.add_child(&quot;B&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(node.name, node.children)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return string representation as Node(name).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Node(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if Node is a leaf (i.e., has no children).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if Node is the root (i.e., has no ancestor).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Node&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a Node as a child to this one.&quot;&quot;&quot;</span>
        <span class="n">new_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span>
        <span class="n">new_node</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">+=</span> <span class="p">(</span><span class="n">new_node</span><span class="p">,)</span>
        <span class="k">return</span> <span class="n">new_node</span>
</code></pre></div>
</details>
<p><div class="highlight"><pre><span></span><code><span class="c1"># example: create a tree of connected Node class instances</span>
<span class="n">node_a</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="s2">&quot;A&quot;</span><span class="p">)</span>
<span class="n">node_a</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="s2">&quot;B&quot;</span><span class="p">)</span>
<span class="n">node_a</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node_a</span><span class="p">,</span> <span class="n">node_a</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Node(A) (Node(B), Node(C))</span>
</code></pre></div></p>
<h2 id="generating-trees">Generating Trees<a class="headerlink" href="#generating-trees" title="Permanent link">&para;</a></h2>
<p>So far we have worked with just a few connected Nodes at a time, but we
want to also be able to work with a tree composed of many connected Nodes.
So let's create a function that can connect many Nodes together automatically.
This function, <code>get_random_tree</code>, will build a tree by repeatedly creating
bifurcations by selecting a tip Node at random (starting with just a single
root Node) and adding two child Nodes until the desired number of tip Nodes 
exist. </p>
<details class="example">
<summary>get_random_tree function definition</summary>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="k">def</span> <span class="nf">get_random_tree</span><span class="p">(</span><span class="n">ntips</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Node&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a ladder-like tree of Node objects with &#39;ntips&#39; tip Nodes.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    ntips: int</span>
<span class="sd">        The number of tip Nodes that must exist before the tree is returned.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Node</span>
<span class="sd">        The root Node of the set of connected Nodes is returned.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># set random seed</span>
    <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="c1"># create root Node with name=root</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># store Nodes in a list that are currently tips</span>
    <span class="n">tips</span> <span class="o">=</span> <span class="p">[</span><span class="n">root</span><span class="p">]</span>

    <span class="c1"># add tip Nodes by splitting &#39;node&#39; into a bifurcation until ntips exist.</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">ntips</span><span class="p">):</span>

        <span class="c1"># randomly sample one of the current tip Nodes</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">tips</span><span class="p">)</span>
        <span class="n">tips</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

        <span class="c1"># create two new tips from &#39;node&#39; and add to tips list  </span>
        <span class="n">child_l</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;left</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">child_r</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;right</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tips</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">child_l</span><span class="p">,</span> <span class="n">child_r</span><span class="p">])</span>

    <span class="c1"># return root Node that now has ntips descended tip Nodes</span>
    <span class="k">return</span> <span class="n">root</span>
</code></pre></div>
</details>
<p><div class="highlight"><pre><span></span><code><span class="c1"># example: create a tree of connected Node class instances</span>
<span class="n">root_node</span> <span class="o">=</span> <span class="n">get_random_tree</span><span class="p">(</span><span class="n">ntips</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">root_node</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Node(root)</span>
</code></pre></div></p>
<p>Using this function we can now create a tree, like above. This example has 
10 tip Nodes, and because it is fully bifurcating, it has 19 total Nodes 
(2 * ntips - 1). We could now interact with the collection of Nodes in this 
tree in a number of ways. For example, we might create a list that includes 
all of the Nodes, or a dict that maps Node names to the Node instances. But 
either of those approaches would essentially linearize the Node collection, 
rather than treating it hierarchically. Instead, our function above has 
returned just one Node instance, the root, as a representation of the entire 
tree. This approach works because we know that every Node is connected to 
some other Node by its pointers, and thus it is possible to visit all Nodes 
by moving down through the hierarchy of children descended from the root 
(i.e., using a tree traversal). </p>
<h2 id="coding-traversal-algorithms">Coding traversal algorithms<a class="headerlink" href="#coding-traversal-algorithms" title="Permanent link">&para;</a></h2>
<p>A traversal algorithm represents a set of rules for consistently iterating
over Nodes in a tree to visit each Node exactly once. There are several
common traversal algorithms which we will cover shortly. The first that 
we will code below is called <em>preorder</em> traversal, which starts at the root
and visits Nodes by proceeding down the left and then right subtrees of each
Node (more on this in a bit).</p>
<p>Coding traversal algorithms is an interesting computational exercise, and
is thus often included as part of an introductory computer science course. 
There are two efficient methods for coding tree traversals: 
<em>recursion</em> and <em>iteration</em>. These two approaches produce identical outcomes,
and are identical in their speed and memory usage. Thus, the decision to 
implement one approach versus the other boils down to preference by the 
developer. Personally, I tend to prefer iterators in most circumstances. 
Both approaches can be very elegant in their simplicity, but I find iteration
to be easier to read and comprehend than recursion. Below I introduce 
both approaches, but we will focus more on the use of iteration afterwards.</p>
<h3 id="traversal-by-recursion">Traversal by recursion<a class="headerlink" href="#traversal-by-recursion" title="Permanent link">&para;</a></h3>
<p>A recursive function is a function that calls itself internally. This approach
is well suited for the Node class object that we have created, since, for 
example, we can write a function that takes a Node as input and then calls
the same function again on the Nodes children (or parent, depending on the
directin of recursion) until there are no more Nodes to operate on. In this
way the function reaches every Node in a very simple and elegant way. </p>
<p>Below is a function called <code>traverse_preorder_by_recursion</code> that takes a 
Node as input and returns an ordered list of Nodes as a result. The returned
list represents the order in which Nodes were visited. To understand how
this Node works read it from top to bottom thinking about what would happen
if it is called on a Node that is a leaf, versus a Node that is not a leaf.
In the case below, we first call it on the root Node (not a leaf), so it
skips the first part of the function, and runs the second part. In the second
part, it creates a list containing the current Node (root), and then adds to
it the result of calling the <code>traverse_preorder_by_recursion</code> function on 
each of its child Nodes. So we need to think about what would be returned
by this function when it is called on those Nodes. Well, if the Node is a 
leaf then it would return the child Node as a list (i.e., it runs the 
first part of the function); if the Node is not a leaf, however, then it 
would do the same thing that happened when it was run on the root, it 
continues recursively to call the same function on its own children until
it is called on a child Node. This is the <em>recursion</em>. Consequently, the 
results from the leaf Nodes are bubbled up until the children of the root
Node is a list of Nodes, which is returned as the result.</p>
<p>If that was confusing, I totally understand. Recursive functions can take
time to understand. Try inserting a print statement into the function to 
print information during each step of the process to better understand what
is going on.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">traverse_preorder_by_recursion</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a list of Nodes in &#39;preorder&#39; traversal order.&quot;&quot;&quot;</span>

    <span class="c1"># Node is a leaf: return the Node</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">node</span><span class="p">]</span>

    <span class="c1"># Node is not leaf: return this Node + func called on each child.</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="n">nodes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">traverse_preorder_by_recursion</span><span class="p">(</span><span class="n">child</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">nodes</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><span class="c1"># example: print the preorder traversal order</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traverse_preorder_by_recursion</span><span class="p">(</span><span class="n">root_node</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># [Node(root), Node(left1), Node(left3), Node(right3), Node(left4), Node(right4), Node(right1), Node(left2), Node(right2)]</span>
</code></pre></div></p>
<h3 id="traversal-by-iteration">Traversal by iteration<a class="headerlink" href="#traversal-by-iteration" title="Permanent link">&para;</a></h3>
<p>Iteration is the process of repetitively executing a process, such as with 
a for-loop. Because this is such a common practice in computation, Python
provides a number of ways to iterate over data structures. One particularly
useful method is the use of <em>generators</em>, which are functions that behave
like an iterator. This means that instead of computing the entire collection
of values in an iterable object before returning it, it instead <em>generates
only the next value at a time and return it when it is requested</em>. This has
a number of advantages. First, it reduces the number of values that need to
be stored in memory; second, it is possible to stop the iteration when a 
desired value is reached before the end; and third, it can be used to write
simpler and more understandable code.</p>
<p>Once you understand generators, using them is quite easy. They are like 
a normal function but instead of using the <code>return</code> expression you instead
use <code>yield</code>. Whereas a function completely stops when <code>return</code> is called, 
<code>yield</code> instead returns the current value and then sits idle, able to continue
from where it left off <em>inside the function</em> when the next value is requested.
Below is an example generator function to iterate over Node objects in 
preorder traversal order. We will discuss this example in more detail in a 
little bit.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">List</span>

<span class="k">def</span> <span class="nf">traverse_preorder_by_iteration</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield Nodes in &#39;preorder&#39; traversal order.&quot;&quot;&quot;</span>
    <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span><span class="p">]</span>
    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">yield</span> <span class="n">node</span>
        <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div>
<p><div class="highlight"><pre><span></span><code><span class="c1"># example: print the preorder traversal order</span>
<span class="nb">print</span><span class="p">(</span><span class="n">traverse_preorder_by_iteration</span><span class="p">(</span><span class="n">root_node</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># &lt;generator object traverse_preorder_by_iteration at 0x7f0166e91660&gt;</span>
</code></pre></div></p>
<p>The first thing you will notice when you call a generator function is that
it does not show the contents of the generator, in contrast to the recursive
function above which returned a list. <em>This is because the contents of the 
generator have not been created yet</em>: you need to iterate over it, where upon
the values will be generated. This could be done with a for-loop, or, a simple
shortcut is to call the <code>list</code> function to convert it to a list. As you can 
see below, this returns a list that is the same order of Nodes as returned by 
the recursive function above.</p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># example: print the preorder traversal order</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">traverse_preorder_by_iteration</span><span class="p">(</span><span class="n">root_node</span><span class="p">)))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># [Node(root), Node(left1), Node(left3), Node(right3), Node(left4), Node(right4), Node(right1), Node(left2), Node(right2)]</span>
</code></pre></div></p>
<!-- 
## Why Traversals are Useful
Now that you have seen two ways to code a traversal function, let's revisit
why this is a useful process in the first place. 

Before we dive deeper into understanding how to code traversal algorithms
let's explore some examples where they are useful, by using either of our
traversal algorithms from above. A preorder traversal ...
 -->

<!-- 
??? Example "Visualize tree"
    <div class="highlight"><pre><span></span><code><span class="c1"># generate a random 8 tip ultrametric tree</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">toytree</span><span class="o">.</span><span class="n">rtree</span><span class="o">.</span><span class="n">imbtree</span><span class="p">(</span><span class="n">ntips</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># draw facing downw with node index labels shown</span>
<span class="n">tree</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">ts</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">node_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">node_sizes</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">tip_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</code></pre></div>

<figure markdown>
  ![Heatmap image](./notebooks/fig4.svg){width="400", loading=lazy}
</figure>
 -->

<h2 id="traversal-strategies">Traversal strategies<a class="headerlink" href="#traversal-strategies" title="Permanent link">&para;</a></h2>
<p>The purpose of a tree traversal is to visit each Node in a specific order 
exactly once. <em>Because from any given Node there is more than one possible 
next node, an algorithm must be used to consistently follow the same set of 
rules for selecting the next node</em>, regardless of the tree size or shape.
Below you can find a description and animation demonstrating the order in 
which nodes are visited under several common traversal algorithms. </p>
<details class="example">
<summary>A function to draw animated trees using toyplot and toytree</summary>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">toyplot</span>
<span class="kn">import</span> <span class="nn">toytree</span>

<span class="c1"># This animation code is a bit advanced, so don&#39;t worry if you do </span>
<span class="c1"># fully understand it at this point. It is included here simply for</span>
<span class="c1"># reference in case it is of interest.</span>

<span class="k">def</span> <span class="nf">plot_traversal_order</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">toytree</span><span class="o">.</span><span class="n">ToyTree</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;postorder&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">toyplot</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">Canvas</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return an animated toyplot canvas showing a traversal order.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    tree: ToyTree</span>
<span class="sd">        A ToyTree class instance that will be drawn and animated.</span>
<span class="sd">    strategy: str</span>
<span class="sd">        The name of a traversal strategy supported by ToyTree.traverse().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># draw the ToyTree with nodes colored</span>
    <span class="n">canvas</span><span class="p">,</span> <span class="n">axes</span><span class="p">,</span> <span class="n">mark</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="n">tip_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">canvas</span><span class="o">.</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">strategy</span><span class="si">}</span><span class="s1">&quot; traversal&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;font-size&quot;</span><span class="p">:</span> <span class="s2">&quot;16px&quot;</span><span class="p">})</span>
    <span class="n">canvas</span><span class="o">.</span><span class="n">style</span><span class="p">[</span><span class="s2">&quot;background-color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>

    <span class="c1"># get node coordinates table</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">get_node_coordinates</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>

    <span class="c1"># get node indices in specified traversal order</span>
    <span class="n">nidxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">idx</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tree</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">strategy</span><span class="p">)]</span>

    <span class="c1"># create labeled markers in traversal order</span>
    <span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="n">toyplot</span><span class="o">.</span><span class="n">marker</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">nidx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nidxs</span><span class="p">)]</span>

    <span class="c1"># get scatterplot Mark</span>
    <span class="n">mark</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">nidxs</span><span class="p">],</span> <span class="n">coords</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">nidxs</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">markers</span><span class="p">)</span>

    <span class="c1"># iterate over each datum as a frame at 2 frames / second</span>
    <span class="k">for</span> <span class="n">frame</span> <span class="ow">in</span> <span class="n">canvas</span><span class="o">.</span><span class="n">frames</span><span class="p">((</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)):</span>

        <span class="c1"># set opacity very low on all Nodes initially</span>
        <span class="k">if</span> <span class="n">frame</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">frame</span><span class="o">.</span><span class="n">set_datum_style</span><span class="p">(</span><span class="n">mark</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;opacity&quot;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">})</span>

        <span class="c1"># increase opacity as each frame </span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">set_datum_style</span><span class="p">(</span><span class="n">mark</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">frame</span><span class="o">.</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;opacity&quot;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">canvas</span>


<span class="c1"># Example: generate random tree and plot &quot;levelorder&quot; traversal strategy.</span>
<span class="n">tree</span> <span class="o">=</span> <span class="n">toytree</span><span class="o">.</span><span class="n">rtree</span><span class="o">.</span><span class="n">unittree</span><span class="p">(</span><span class="n">ntips</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;levelorder&quot;</span><span class="p">,</span> <span class="s2">&quot;postorder&quot;</span><span class="p">,</span> <span class="s2">&quot;preorder&quot;</span><span class="p">,</span> <span class="s2">&quot;idxorder&quot;</span><span class="p">]:</span>
    <span class="n">canvas</span> <span class="o">=</span> <span class="n">plot_traversal_order</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">strategy</span><span class="p">)</span>
    <span class="n">toyplot</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;traversal-</span><span class="si">{</span><span class="n">strategy</span><span class="si">}</span><span class="s2">-animated.html&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;text-align&quot;</span><span class="p">:</span> <span class="s2">&quot;center&quot;</span><span class="p">})</span>
</code></pre></div>
</details>
<!-- 
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
 -->

<h4 id="levelorder-traversal"><em>levelorder</em> traversal<a class="headerlink" href="#levelorder-traversal" title="Permanent link">&para;</a></h4>
<p>A <em>levelorder</em> traversal (also called a breadth-first search BFS) is an 
algorithm that starts at the root and visits all Nodes at a given depth
descended from the root before moving to the next level. The Nodes in each
level are visited in left to right order in <code>toytree</code>, but the opposite
could just as easily be implemented. 
The primary utility of this traversal strategy is that it is topologically 
sorted, such that a parent is always visited before any of its children.</p>
<div class="toyplot" id="t441d115920fb4cd49438049fde184d4b" style="text-align:center"><svg class="toyplot-canvas-Canvas" xmlns:toyplot="http://www.sandia.gov/toyplot" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="350.0px" height="250.0px" viewBox="0 0 350.0 250.0" preserveAspectRatio="xMidYMid meet" style="background-color:white;border-color:#292724;border-style:none;border-width:1.0;fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:Helvetica;font-size:12px;opacity:1.0;stroke:rgb(16.1%,15.3%,14.1%);stroke-opacity:1.0;stroke-width:1.0" id="te41e50b4ea13478e83d44cfe26ac8365"><g class="toyplot-coordinates-Cartesian" id="t78ea1be739cc4f4bb433a08ddd426fb0"><clipPath id="t15972abfa37b477fb7a916a814804d70"><rect x="35.0" y="35.0" width="280.0" height="180.0"></rect></clipPath><g clip-path="url(#t15972abfa37b477fb7a916a814804d70)"><g class="toytree-mark-Toytree" id="t5ca8dd1d09224e22a59ffde6b354af30"><g class="toytree-Edges" style="fill:none;stroke:rgba(16.1%,15.3%,14.1%,1.000);stroke-linecap:round;stroke-width:2.0"><path d="M 67.9 162.5 L 50.0 162.5 L 50.0 200.0" id="8,0" style="stroke-width:nan"></path><path d="M 67.9 162.5 L 85.7 162.5 L 85.7 200.0" id="8,1" style="stroke-width:nan"></path><path d="M 139.3 162.5 L 121.4 162.5 L 121.4 200.0" id="9,2" style="stroke-width:nan"></path><path d="M 139.3 162.5 L 157.1 162.5 L 157.1 200.0" id="9,3" style="stroke-width:nan"></path><path d="M 210.7 125.0 L 192.9 125.0 L 192.9 200.0" id="11,4" style="stroke-width:nan"></path><path d="M 210.7 125.0 L 228.6 125.0 L 228.6 200.0" id="11,5" style="stroke-width:nan"></path><path d="M 282.1 87.5 L 264.3 87.5 L 264.3 200.0" id="13,6" style="stroke-width:nan"></path><path d="M 282.1 87.5 L 300.0 87.5 L 300.0 200.0" id="13,7" style="stroke-width:nan"></path><path d="M 103.6 125.0 L 67.9 125.0 L 67.9 162.5" id="10,8" style="stroke-width:nan"></path><path d="M 103.6 125.0 L 139.3 125.0 L 139.3 162.5" id="10,9" style="stroke-width:nan"></path><path d="M 157.1 87.5 L 103.6 87.5 L 103.6 125.0" id="12,10" style="stroke-width:nan"></path><path d="M 157.1 87.5 L 210.7 87.5 L 210.7 125.0" id="12,11" style="stroke-width:nan"></path><path d="M 219.6 50.0 L 157.1 50.0 L 157.1 87.5" id="14,12" style="stroke-width:nan"></path><path d="M 219.6 50.0 L 282.1 50.0 L 282.1 87.5" id="14,13" style="stroke-width:nan"></path></g></g><g class="toyplot-mark-Point" id="t4e259691fde1461c81483298e47b5c8d"><g class="toyplot-Series"><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(219.64285714285717, 50.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">0</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(157.1428571428571, 87.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">1</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(282.1428571428571, 87.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">2</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(103.57142857142856, 125.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">3</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(210.71428571428572, 125.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">4</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(264.2857142857143, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">5</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(300.0, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">6</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(67.85714285714286, 162.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">7</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(139.28571428571428, 162.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">8</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(192.85714285714283, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">9</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(228.57142857142856, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">10</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(50.0, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">11</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(85.71428571428572, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">12</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(121.42857142857142, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">13</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(157.1428571428571, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">14</text></g></g></g></g></g></g><g class="toyplot-mark-Text" id="t4cdf235e3ebe415692ecafc7df06d6fd"><g class="toyplot-Series"><g class="toyplot-Datum" transform="translate(175.0,20.0)"><text x="-73.696" y="4.087999999999999" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:16.0px;font-weight:normal;opacity:1;stroke:none;vertical-align:baseline;white-space:pre">"levelorder" traversal</text></g></g></g></svg><div class="toyplot-behavior"><script>(function()
{
var modules={};
modules["toyplot/tables"] = (function()
    {
        var tables = [];

        var module = {};

        module.set = function(owner, key, names, columns)
        {
            tables.push({owner: owner, key: key, names: names, columns: columns});
        }

        module.get = function(owner, key)
        {
            for(var i = 0; i != tables.length; ++i)
            {
                var table = tables[i];
                if(table.owner != owner)
                    continue;
                if(table.key != key)
                    continue;
                return {names: table.names, columns: table.columns};
            }
        }

        module.get_csv = function(owner, key)
        {
            var table = module.get(owner, key);
            if(table != undefined)
            {
                var csv = "";
                csv += table.names.join(",") + "\n";
                for(var i = 0; i != table.columns[0].length; ++i)
                {
                  for(var j = 0; j != table.columns.length; ++j)
                  {
                    if(j)
                      csv += ",";
                    csv += table.columns[j][i];
                  }
                  csv += "\n";
                }
                return csv;
            }
        }

        return module;
    })();
modules["toyplot/root/id"] = "t441d115920fb4cd49438049fde184d4b";
modules["toyplot/root"] = (function(root_id)
    {
        return document.querySelector("#" + root_id);
    })(modules["toyplot/root/id"]);
modules["toyplot/canvas/id"] = "te41e50b4ea13478e83d44cfe26ac8365";
modules["toyplot/canvas"] = (function(canvas_id)
    {
        return document.querySelector("#" + canvas_id);
    })(modules["toyplot/canvas/id"]);
modules["toyplot/menus/context"] = (function(root, canvas)
    {
        var wrapper = document.createElement("div");
        wrapper.innerHTML = "<ul class='toyplot-context-menu' style='background:#eee; border:1px solid #b8b8b8; border-radius:5px; box-shadow: 0px 0px 8px rgba(0%,0%,0%,0.25); margin:0; padding:3px 0; position:fixed; visibility:hidden;'></ul>"
        var menu = wrapper.firstChild;

        root.appendChild(menu);

        var items = [];

        var ignore_mouseup = null;
        function open_menu(e)
        {
            var show_menu = false;
            for(var index=0; index != items.length; ++index)
            {
                var item = items[index];
                if(item.show(e))
                {
                    item.item.style.display = "block";
                    show_menu = true;
                }
                else
                {
                    item.item.style.display = "none";
                }
            }

            if(show_menu)
            {
                ignore_mouseup = true;
                menu.style.left = (e.clientX + 1) + "px";
                menu.style.top = (e.clientY - 5) + "px";
                menu.style.visibility = "visible";
                e.stopPropagation();
                e.preventDefault();
            }
        }

        function close_menu()
        {
            menu.style.visibility = "hidden";
        }

        function contextmenu(e)
        {
            open_menu(e);
        }

        function mousemove(e)
        {
            ignore_mouseup = false;
        }

        function mouseup(e)
        {
            if(ignore_mouseup)
            {
                ignore_mouseup = false;
                return;
            }
            close_menu();
        }

        function keydown(e)
        {
            if(e.key == "Escape" || e.key == "Esc" || e.keyCode == 27)
            {
                close_menu();
            }
        }

        canvas.addEventListener("contextmenu", contextmenu);
        canvas.addEventListener("mousemove", mousemove);
        document.addEventListener("mouseup", mouseup);
        document.addEventListener("keydown", keydown);

        var module = {};
        module.add_item = function(label, show, activate)
        {
            var wrapper = document.createElement("div");
            wrapper.innerHTML = "<li class='toyplot-context-menu-item' style='background:#eee; color:#333; padding:2px 20px; list-style:none; margin:0; text-align:left;'>" + label + "</li>"
            var item = wrapper.firstChild;

            items.push({item: item, show: show});

            function mouseover()
            {
                this.style.background = "steelblue";
                this.style.color = "white";
            }

            function mouseout()
            {
                this.style.background = "#eee";
                this.style.color = "#333";
            }

            function choose_item(e)
            {
                close_menu();
                activate();

                e.stopPropagation();
                e.preventDefault();
            }

            item.addEventListener("mouseover", mouseover);
            item.addEventListener("mouseout", mouseout);
            item.addEventListener("mouseup", choose_item);
            item.addEventListener("contextmenu", choose_item);

            menu.appendChild(item);
        };
        return module;
    })(modules["toyplot/root"],modules["toyplot/canvas"]);
modules["toyplot/io"] = (function()
    {
        var module = {};
        module.save_file = function(mime_type, charset, data, filename)
        {
            var uri = "data:" + mime_type + ";charset=" + charset + "," + data;
            uri = encodeURI(uri);

            var link = document.createElement("a");
            if(typeof link.download != "undefined")
            {
              link.href = uri;
              link.style = "visibility:hidden";
              link.download = filename;

              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
            }
            else
            {
              window.open(uri);
            }
        };
        return module;
    })();
(function(tables, context_menu, io, owner_id, key, label, names, columns, filename)
        {
            tables.set(owner_id, key, names, columns);

            var owner = document.querySelector("#" + owner_id);
            function show_item(e)
            {
                return owner.contains(e.target);
            }

            function choose_item()
            {
                io.save_file("text/csv", "utf-8", tables.get_csv(owner_id, key), filename + ".csv");
            }

            context_menu.add_item("Save " + label + " as CSV", show_item, choose_item);
        })(modules["toyplot/tables"],modules["toyplot/menus/context"],modules["toyplot/io"],"t4e259691fde1461c81483298e47b5c8d","data","point",["x", "y0"],[[4.75, 3.0, 6.5, 1.5, 4.5, 6.0, 7.0, 0.5, 2.5, 4.0, 5.0, 0.0, 1.0, 2.0, 3.0], [1.0, 0.75, 0.75, 0.5, 0.5, 0.0, 0.0, 0.25, 0.25, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]],"toyplot");
})();</script><div class="toyplot-vcr-controls" style="display:none">
            <input class="toyplot-current-frame" title="Frame" type="range" min="0" max="16" step="1" value="0">
            <button class="toyplot-rewind" title="Rewind" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="10,5 0,10 10,15" stroke="none" fill="#292724"></polygon>
                    <polygon points="20,5 10,10 20,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-reverse-play" title="Reverse Play" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="15,5 5,10 15,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-frame-rewind" title="Frame Rewind" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="15,5 5,10 15,15" stroke="none" fill="#292724"></polygon>
                    <rect x="17" y="5" width="2" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-stop" title="Stop" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <rect x="5" y="5" width="10" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-frame-advance" title="Frame Advance" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="5,5 15,10 5,15" stroke="none" fill="#292724"></polygon>
                    <rect x="1" y="5" width="2" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-forward-play" title="Play" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="5,5 15,10 5,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-fast-forward" title="Fast Forward" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="0,5 10,10 0,15" stroke="none" fill="#292724"></polygon>
                    <polygon points="10,5 20,10 10,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
        </div><script>
        (function()
        {
            var root_id = "t441d115920fb4cd49438049fde184d4b";
            var frame_durations = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5];
            var state_changes = [{"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 0, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 1, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 2, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 3, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 4, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 5, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 6, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 7, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 8, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 9, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 10, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 11, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 12, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 13, "style": {"opacity": 0.1}}, {"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 14, "style": {"opacity": 0.1}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 0, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 1, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 2, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 3, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 4, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 5, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 6, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 7, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 8, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 9, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 10, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 11, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 12, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 13, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t4e259691fde1461c81483298e47b5c8d", "series": 0, "datum": 14, "style": {"opacity": 1.0}}]}];

            var current_frame = null;
            var timeout = null;

            function set_timeout(value)
            {
                if(timeout !== null)
                    window.clearTimeout(timeout);
                timeout = value;
            }

            function set_current_frame(frame)
            {
                current_frame = frame;
                document.querySelector("#" + root_id + " .toyplot-current-frame").value = frame;
            }

            function play_reverse()
            {
                set_current_frame((current_frame - 1 + frame_durations.length) % frame_durations.length);
                render_changes(0, current_frame+1)
                set_timeout(window.setTimeout(play_reverse, frame_durations[(current_frame - 1 + frame_durations.length) % frame_durations.length] * 1000));
            }

            function play_forward()
            {
                set_current_frame((current_frame + 1) % frame_durations.length);
                render_changes(current_frame, current_frame+1);
                set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));
            }

            var item_cache = {};
            function get_item(id)
            {
                if(!(id in item_cache))
                    item_cache[id] = document.getElementById(id);
                return item_cache[id];
            }

            function render_changes(begin, end)
            {
                for(var frame = begin; frame != end; ++frame)
                {
                    var changes = state_changes[frame];
                    for(var type in changes)
                    {
                        var states = changes[type]
                        if(type == "set-mark-style")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var mark = get_item(state.mark);
                                for(var key in state.style)
                                {
                                    mark.style.setProperty(key, state[1][key]);
                                }
                            }
                        }
                        else if(type == "set-datum-style")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var datum = get_item(state.mark).querySelectorAll(".toyplot-Series")[state.series].querySelectorAll(".toyplot-Datum")[state.datum];
                                for(var key in state.style)
                                {
                                    datum.style.setProperty(key, state.style[key]);
                                }
                            }
                        }
                        else if(type == "set-datum-text")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var datum = get_item(state.mark).querySelectorAll(".toyplot-Series")[state.series].querySelectorAll(".toyplot-Datum")[state.datum];
                                var layout = document.createElementNS("http://www.w3.org/2000/svg", "g");
                                layout.innerHTML = state.layout;
                                layout = layout.firstChild;

                                while(datum.firstElementChild)
                                    datum.removeChild(datum.firstElementChild);
                                while(layout.firstElementChild)
                                    datum.appendChild(layout.removeChild(layout.firstElementChild));
                            }
                        }
                    }
                }
            }

            function on_set_frame()
            {
            set_timeout(null);
            set_current_frame(document.querySelector("#" + root_id + " .toyplot-current-frame").valueAsNumber);
            render_changes(0, current_frame+1);
            }

            function on_frame_rewind()
            {
            set_timeout(null);
            set_current_frame((current_frame - 1 + frame_durations.length) % frame_durations.length);
            render_changes(0, current_frame+1);
            }

            function on_rewind()
            {
            set_current_frame(0);
            render_changes(0, current_frame+1);
            }

            function on_play_reverse()
            {
            set_timeout(window.setTimeout(play_reverse, frame_durations[(current_frame - 1 + frame_durations.length) % frame_durations.length] * 1000));
            }

            function on_stop()
            {
            set_timeout(null);
            }

            function on_play_forward()
            {
            set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));
            }

            function on_fast_forward()
            {
            set_timeout(null);
            set_current_frame(frame_durations.length - 1);
            render_changes(0, current_frame + 1)
            }

            function on_frame_advance()
            {
            set_timeout(null);
            set_current_frame((current_frame + 1) % frame_durations.length);
            render_changes(current_frame, current_frame+1);
            }

            set_current_frame(0);
            render_changes(0, current_frame+1);
            set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));            

            document.querySelector("#" + root_id + " .toyplot-current-frame").oninput = on_set_frame;
            document.querySelector("#" + root_id + " .toyplot-rewind").onclick = on_rewind;
            document.querySelector("#" + root_id + " .toyplot-reverse-play").onclick = on_play_reverse;
            document.querySelector("#" + root_id + " .toyplot-frame-rewind").onclick = on_frame_rewind;
            document.querySelector("#" + root_id + " .toyplot-stop").onclick = on_stop;
            document.querySelector("#" + root_id + " .toyplot-frame-advance").onclick = on_frame_advance;
            document.querySelector("#" + root_id + " .toyplot-forward-play").onclick = on_play_forward;
            document.querySelector("#" + root_id + " .toyplot-fast-forward").onclick = on_fast_forward;
        })();
        </script></div></div>

<!-- 
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
 -->

<h4 id="preorder-traversal"><em>preorder</em> traversal<a class="headerlink" href="#preorder-traversal" title="Permanent link">&para;</a></h4>
<p>A <em>preorder</em> traversal is an example of a <a href="https://en.wikipedia.org/wiki/Depth-first_search">Depth-first search algorithm</a>. 
It starts at the root Node and explores as far as possible along each 
descendant subtree before backtracking. The default in <code>toytree</code> is to 
visit the left subtree before the right subtree, such that the algorithm
could be summarized as NLR (Node, left subtree, right subtree). The primary
utility of this traversal strategy is that it is <em>topologically sorted</em>, such
that a <strong>parent is always visited before any of its children</strong>. This property
is also shared with <em>levelorder</em> traversal. The primary concern in distinguishing
between these two strategies is if you plan to stop the traversal when a certain
Node is found (e.g., to prevent having to traverse a very large set of Nodes), 
in which case the two will differ in the order in which they may find
the stopping Node.</p>
<div class="toyplot" id="t706c0135b55641229977c2d93cd9f5a7" style="text-align:center"><svg class="toyplot-canvas-Canvas" xmlns:toyplot="http://www.sandia.gov/toyplot" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="350.0px" height="250.0px" viewBox="0 0 350.0 250.0" preserveAspectRatio="xMidYMid meet" style="background-color:white;border-color:#292724;border-style:none;border-width:1.0;fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:Helvetica;font-size:12px;opacity:1.0;stroke:rgb(16.1%,15.3%,14.1%);stroke-opacity:1.0;stroke-width:1.0" id="t424fa1640ed24734a3d29025dff20961"><g class="toyplot-coordinates-Cartesian" id="t32a75da5607848b7bd5d01d68eda026e"><clipPath id="t92136f6c7ff743ce81d6e1d80418ad13"><rect x="35.0" y="35.0" width="280.0" height="180.0"></rect></clipPath><g clip-path="url(#t92136f6c7ff743ce81d6e1d80418ad13)"><g class="toytree-mark-Toytree" id="t5ef4ef4d34434e5c82e9b59101096d83"><g class="toytree-Edges" style="fill:none;stroke:rgba(16.1%,15.3%,14.1%,1.000);stroke-linecap:round;stroke-width:2.0"><path d="M 67.9 162.5 L 50.0 162.5 L 50.0 200.0" id="8,0" style="stroke-width:nan"></path><path d="M 67.9 162.5 L 85.7 162.5 L 85.7 200.0" id="8,1" style="stroke-width:nan"></path><path d="M 139.3 162.5 L 121.4 162.5 L 121.4 200.0" id="9,2" style="stroke-width:nan"></path><path d="M 139.3 162.5 L 157.1 162.5 L 157.1 200.0" id="9,3" style="stroke-width:nan"></path><path d="M 210.7 125.0 L 192.9 125.0 L 192.9 200.0" id="11,4" style="stroke-width:nan"></path><path d="M 210.7 125.0 L 228.6 125.0 L 228.6 200.0" id="11,5" style="stroke-width:nan"></path><path d="M 282.1 87.5 L 264.3 87.5 L 264.3 200.0" id="13,6" style="stroke-width:nan"></path><path d="M 282.1 87.5 L 300.0 87.5 L 300.0 200.0" id="13,7" style="stroke-width:nan"></path><path d="M 103.6 125.0 L 67.9 125.0 L 67.9 162.5" id="10,8" style="stroke-width:nan"></path><path d="M 103.6 125.0 L 139.3 125.0 L 139.3 162.5" id="10,9" style="stroke-width:nan"></path><path d="M 157.1 87.5 L 103.6 87.5 L 103.6 125.0" id="12,10" style="stroke-width:nan"></path><path d="M 157.1 87.5 L 210.7 87.5 L 210.7 125.0" id="12,11" style="stroke-width:nan"></path><path d="M 219.6 50.0 L 157.1 50.0 L 157.1 87.5" id="14,12" style="stroke-width:nan"></path><path d="M 219.6 50.0 L 282.1 50.0 L 282.1 87.5" id="14,13" style="stroke-width:nan"></path></g></g><g class="toyplot-mark-Point" id="t9d416c93df784344afb16ad0ecca5360"><g class="toyplot-Series"><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(219.64285714285717, 50.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">0</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(157.1428571428571, 87.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">1</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(103.57142857142856, 125.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">2</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(67.85714285714286, 162.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">3</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(50.0, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">4</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(85.71428571428572, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">5</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(139.28571428571428, 162.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">6</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(121.42857142857142, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">7</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(157.1428571428571, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">8</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(210.71428571428572, 125.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">9</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(192.85714285714283, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">10</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(228.57142857142856, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">11</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(282.1428571428571, 87.5)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">12</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(264.2857142857143, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">13</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(300.0, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">14</text></g></g></g></g></g></g><g class="toyplot-mark-Text" id="ta26ab985edeb475588bb963653046160"><g class="toyplot-Series"><g class="toyplot-Datum" transform="translate(175.0,20.0)"><text x="-68.808" y="4.087999999999999" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:16.0px;font-weight:normal;opacity:1;stroke:none;vertical-align:baseline;white-space:pre">"preorder" traversal</text></g></g></g></svg><div class="toyplot-behavior"><script>(function()
{
var modules={};
modules["toyplot/tables"] = (function()
    {
        var tables = [];

        var module = {};

        module.set = function(owner, key, names, columns)
        {
            tables.push({owner: owner, key: key, names: names, columns: columns});
        }

        module.get = function(owner, key)
        {
            for(var i = 0; i != tables.length; ++i)
            {
                var table = tables[i];
                if(table.owner != owner)
                    continue;
                if(table.key != key)
                    continue;
                return {names: table.names, columns: table.columns};
            }
        }

        module.get_csv = function(owner, key)
        {
            var table = module.get(owner, key);
            if(table != undefined)
            {
                var csv = "";
                csv += table.names.join(",") + "\n";
                for(var i = 0; i != table.columns[0].length; ++i)
                {
                  for(var j = 0; j != table.columns.length; ++j)
                  {
                    if(j)
                      csv += ",";
                    csv += table.columns[j][i];
                  }
                  csv += "\n";
                }
                return csv;
            }
        }

        return module;
    })();
modules["toyplot/root/id"] = "t706c0135b55641229977c2d93cd9f5a7";
modules["toyplot/root"] = (function(root_id)
    {
        return document.querySelector("#" + root_id);
    })(modules["toyplot/root/id"]);
modules["toyplot/canvas/id"] = "t424fa1640ed24734a3d29025dff20961";
modules["toyplot/canvas"] = (function(canvas_id)
    {
        return document.querySelector("#" + canvas_id);
    })(modules["toyplot/canvas/id"]);
modules["toyplot/menus/context"] = (function(root, canvas)
    {
        var wrapper = document.createElement("div");
        wrapper.innerHTML = "<ul class='toyplot-context-menu' style='background:#eee; border:1px solid #b8b8b8; border-radius:5px; box-shadow: 0px 0px 8px rgba(0%,0%,0%,0.25); margin:0; padding:3px 0; position:fixed; visibility:hidden;'></ul>"
        var menu = wrapper.firstChild;

        root.appendChild(menu);

        var items = [];

        var ignore_mouseup = null;
        function open_menu(e)
        {
            var show_menu = false;
            for(var index=0; index != items.length; ++index)
            {
                var item = items[index];
                if(item.show(e))
                {
                    item.item.style.display = "block";
                    show_menu = true;
                }
                else
                {
                    item.item.style.display = "none";
                }
            }

            if(show_menu)
            {
                ignore_mouseup = true;
                menu.style.left = (e.clientX + 1) + "px";
                menu.style.top = (e.clientY - 5) + "px";
                menu.style.visibility = "visible";
                e.stopPropagation();
                e.preventDefault();
            }
        }

        function close_menu()
        {
            menu.style.visibility = "hidden";
        }

        function contextmenu(e)
        {
            open_menu(e);
        }

        function mousemove(e)
        {
            ignore_mouseup = false;
        }

        function mouseup(e)
        {
            if(ignore_mouseup)
            {
                ignore_mouseup = false;
                return;
            }
            close_menu();
        }

        function keydown(e)
        {
            if(e.key == "Escape" || e.key == "Esc" || e.keyCode == 27)
            {
                close_menu();
            }
        }

        canvas.addEventListener("contextmenu", contextmenu);
        canvas.addEventListener("mousemove", mousemove);
        document.addEventListener("mouseup", mouseup);
        document.addEventListener("keydown", keydown);

        var module = {};
        module.add_item = function(label, show, activate)
        {
            var wrapper = document.createElement("div");
            wrapper.innerHTML = "<li class='toyplot-context-menu-item' style='background:#eee; color:#333; padding:2px 20px; list-style:none; margin:0; text-align:left;'>" + label + "</li>"
            var item = wrapper.firstChild;

            items.push({item: item, show: show});

            function mouseover()
            {
                this.style.background = "steelblue";
                this.style.color = "white";
            }

            function mouseout()
            {
                this.style.background = "#eee";
                this.style.color = "#333";
            }

            function choose_item(e)
            {
                close_menu();
                activate();

                e.stopPropagation();
                e.preventDefault();
            }

            item.addEventListener("mouseover", mouseover);
            item.addEventListener("mouseout", mouseout);
            item.addEventListener("mouseup", choose_item);
            item.addEventListener("contextmenu", choose_item);

            menu.appendChild(item);
        };
        return module;
    })(modules["toyplot/root"],modules["toyplot/canvas"]);
modules["toyplot/io"] = (function()
    {
        var module = {};
        module.save_file = function(mime_type, charset, data, filename)
        {
            var uri = "data:" + mime_type + ";charset=" + charset + "," + data;
            uri = encodeURI(uri);

            var link = document.createElement("a");
            if(typeof link.download != "undefined")
            {
              link.href = uri;
              link.style = "visibility:hidden";
              link.download = filename;

              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
            }
            else
            {
              window.open(uri);
            }
        };
        return module;
    })();
(function(tables, context_menu, io, owner_id, key, label, names, columns, filename)
        {
            tables.set(owner_id, key, names, columns);

            var owner = document.querySelector("#" + owner_id);
            function show_item(e)
            {
                return owner.contains(e.target);
            }

            function choose_item()
            {
                io.save_file("text/csv", "utf-8", tables.get_csv(owner_id, key), filename + ".csv");
            }

            context_menu.add_item("Save " + label + " as CSV", show_item, choose_item);
        })(modules["toyplot/tables"],modules["toyplot/menus/context"],modules["toyplot/io"],"t9d416c93df784344afb16ad0ecca5360","data","point",["x", "y0"],[[4.75, 3.0, 1.5, 0.5, 0.0, 1.0, 2.5, 2.0, 3.0, 4.5, 4.0, 5.0, 6.5, 6.0, 7.0], [1.0, 0.75, 0.5, 0.25, 0.0, 0.0, 0.25, 0.0, 0.0, 0.5, 0.0, 0.0, 0.75, 0.0, 0.0]],"toyplot");
})();</script><div class="toyplot-vcr-controls" style="display: none;">
            <input class="toyplot-current-frame" title="Frame" type="range" min="0" max="16" step="1" value="0">
            <button class="toyplot-rewind" title="Rewind" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="10,5 0,10 10,15" stroke="none" fill="#292724"></polygon>
                    <polygon points="20,5 10,10 20,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-reverse-play" title="Reverse Play" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="15,5 5,10 15,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-frame-rewind" title="Frame Rewind" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="15,5 5,10 15,15" stroke="none" fill="#292724"></polygon>
                    <rect x="17" y="5" width="2" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-stop" title="Stop" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <rect x="5" y="5" width="10" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-frame-advance" title="Frame Advance" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="5,5 15,10 5,15" stroke="none" fill="#292724"></polygon>
                    <rect x="1" y="5" width="2" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-forward-play" title="Play" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="5,5 15,10 5,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-fast-forward" title="Fast Forward" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="0,5 10,10 0,15" stroke="none" fill="#292724"></polygon>
                    <polygon points="10,5 20,10 10,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
        </div><script>
        (function()
        {
            var root_id = "t706c0135b55641229977c2d93cd9f5a7";
            var frame_durations = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5];
            var state_changes = [{"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 0, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 1, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 2, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 3, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 4, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 5, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 6, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 7, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 8, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 9, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 10, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 11, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 12, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 13, "style": {"opacity": 0.1}}, {"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 14, "style": {"opacity": 0.1}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 0, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 1, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 2, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 3, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 4, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 5, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 6, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 7, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 8, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 9, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 10, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 11, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 12, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 13, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t9d416c93df784344afb16ad0ecca5360", "series": 0, "datum": 14, "style": {"opacity": 1.0}}]}];

            var current_frame = null;
            var timeout = null;

            function set_timeout(value)
            {
                if(timeout !== null)
                    window.clearTimeout(timeout);
                timeout = value;
            }

            function set_current_frame(frame)
            {
                current_frame = frame;
                document.querySelector("#" + root_id + " .toyplot-current-frame").value = frame;
            }

            function play_reverse()
            {
                set_current_frame((current_frame - 1 + frame_durations.length) % frame_durations.length);
                render_changes(0, current_frame+1)
                set_timeout(window.setTimeout(play_reverse, frame_durations[(current_frame - 1 + frame_durations.length) % frame_durations.length] * 1000));
            }

            function play_forward()
            {
                set_current_frame((current_frame + 1) % frame_durations.length);
                render_changes(current_frame, current_frame+1);
                set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));
            }

            var item_cache = {};
            function get_item(id)
            {
                if(!(id in item_cache))
                    item_cache[id] = document.getElementById(id);
                return item_cache[id];
            }

            function render_changes(begin, end)
            {
                for(var frame = begin; frame != end; ++frame)
                {
                    var changes = state_changes[frame];
                    for(var type in changes)
                    {
                        var states = changes[type]
                        if(type == "set-mark-style")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var mark = get_item(state.mark);
                                for(var key in state.style)
                                {
                                    mark.style.setProperty(key, state[1][key]);
                                }
                            }
                        }
                        else if(type == "set-datum-style")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var datum = get_item(state.mark).querySelectorAll(".toyplot-Series")[state.series].querySelectorAll(".toyplot-Datum")[state.datum];
                                for(var key in state.style)
                                {
                                    datum.style.setProperty(key, state.style[key]);
                                }
                            }
                        }
                        else if(type == "set-datum-text")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var datum = get_item(state.mark).querySelectorAll(".toyplot-Series")[state.series].querySelectorAll(".toyplot-Datum")[state.datum];
                                var layout = document.createElementNS("http://www.w3.org/2000/svg", "g");
                                layout.innerHTML = state.layout;
                                layout = layout.firstChild;

                                while(datum.firstElementChild)
                                    datum.removeChild(datum.firstElementChild);
                                while(layout.firstElementChild)
                                    datum.appendChild(layout.removeChild(layout.firstElementChild));
                            }
                        }
                    }
                }
            }

            function on_set_frame()
            {
            set_timeout(null);
            set_current_frame(document.querySelector("#" + root_id + " .toyplot-current-frame").valueAsNumber);
            render_changes(0, current_frame+1);
            }

            function on_frame_rewind()
            {
            set_timeout(null);
            set_current_frame((current_frame - 1 + frame_durations.length) % frame_durations.length);
            render_changes(0, current_frame+1);
            }

            function on_rewind()
            {
            set_current_frame(0);
            render_changes(0, current_frame+1);
            }

            function on_play_reverse()
            {
            set_timeout(window.setTimeout(play_reverse, frame_durations[(current_frame - 1 + frame_durations.length) % frame_durations.length] * 1000));
            }

            function on_stop()
            {
            set_timeout(null);
            }

            function on_play_forward()
            {
            set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));
            }

            function on_fast_forward()
            {
            set_timeout(null);
            set_current_frame(frame_durations.length - 1);
            render_changes(0, current_frame + 1)
            }

            function on_frame_advance()
            {
            set_timeout(null);
            set_current_frame((current_frame + 1) % frame_durations.length);
            render_changes(current_frame, current_frame+1);
            }

            set_current_frame(0);
            render_changes(0, current_frame+1);
            set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));

            document.querySelector("#" + root_id + " .toyplot-current-frame").oninput = on_set_frame;
            document.querySelector("#" + root_id + " .toyplot-rewind").onclick = on_rewind;
            document.querySelector("#" + root_id + " .toyplot-reverse-play").onclick = on_play_reverse;
            document.querySelector("#" + root_id + " .toyplot-frame-rewind").onclick = on_frame_rewind;
            document.querySelector("#" + root_id + " .toyplot-stop").onclick = on_stop;
            document.querySelector("#" + root_id + " .toyplot-frame-advance").onclick = on_frame_advance;
            document.querySelector("#" + root_id + " .toyplot-forward-play").onclick = on_play_forward;
            document.querySelector("#" + root_id + " .toyplot-fast-forward").onclick = on_fast_forward;
        })();
        </script></div></div>

<!-- 
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
 -->

<h4 id="postorder-traversal"><em>postorder</em> traversal<a class="headerlink" href="#postorder-traversal" title="Permanent link">&para;</a></h4>
<p>A <em>preorder</em> traversal is also a Depth-first search algorithm, similar to 
<em>postorder</em> traversal. It starts by traversing down the left subtree from
the root until it reaches a tip Node (i.e., no more left subtree exists on the
current Node), it then checks for a right subtree, and then visits the 
current Node. As with other algorithms, it could similarly be designed to
visit right before left. Given the implementation in <code>toytree</code>, this algorithm
could be summarized as LRN (left subtree, right subtree, Node). The primary 
utility of this traversal strategy is that it is topologically sorted, 
such that a <strong>all children are always visited before their parent</strong>. This is
especially useful for algorithms where parent values are calculated dependent
on their child values. In a phylogenetic context, this involves algorithms 
for calculating likelihoods of data observed at the tips, for inferring
ancestral state reconstructions, node depth/height calculations, and many more.</p>
<div class="toyplot" id="td56f59eb992640b09c70ba3bf9b103d0" style="text-align:center"><svg class="toyplot-canvas-Canvas" xmlns:toyplot="http://www.sandia.gov/toyplot" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="350.0px" height="250.0px" viewBox="0 0 350.0 250.0" preserveAspectRatio="xMidYMid meet" style="background-color:white;border-color:#292724;border-style:none;border-width:1.0;fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:Helvetica;font-size:12px;opacity:1.0;stroke:rgb(16.1%,15.3%,14.1%);stroke-opacity:1.0;stroke-width:1.0" id="td377ae4473a54e138eb02c4f266ee3ae"><g class="toyplot-coordinates-Cartesian" id="t6b6e1b06079849178155baef811018e4"><clipPath id="t2d0352db69824c8eb78ba9d1f449a882"><rect x="35.0" y="35.0" width="280.0" height="180.0"></rect></clipPath><g clip-path="url(#t2d0352db69824c8eb78ba9d1f449a882)"><g class="toytree-mark-Toytree" id="t009b417d5ec9439ab3b0a1435c29b339"><g class="toytree-Edges" style="fill:none;stroke:rgba(16.1%,15.3%,14.1%,1.000);stroke-linecap:round;stroke-width:2.0"><path d="M 67.9 162.5 L 50.0 162.5 L 50.0 200.0" id="8,0" style="stroke-width:nan"></path><path d="M 67.9 162.5 L 85.7 162.5 L 85.7 200.0" id="8,1" style="stroke-width:nan"></path><path d="M 139.3 162.5 L 121.4 162.5 L 121.4 200.0" id="9,2" style="stroke-width:nan"></path><path d="M 139.3 162.5 L 157.1 162.5 L 157.1 200.0" id="9,3" style="stroke-width:nan"></path><path d="M 210.7 125.0 L 192.9 125.0 L 192.9 200.0" id="11,4" style="stroke-width:nan"></path><path d="M 210.7 125.0 L 228.6 125.0 L 228.6 200.0" id="11,5" style="stroke-width:nan"></path><path d="M 282.1 87.5 L 264.3 87.5 L 264.3 200.0" id="13,6" style="stroke-width:nan"></path><path d="M 282.1 87.5 L 300.0 87.5 L 300.0 200.0" id="13,7" style="stroke-width:nan"></path><path d="M 103.6 125.0 L 67.9 125.0 L 67.9 162.5" id="10,8" style="stroke-width:nan"></path><path d="M 103.6 125.0 L 139.3 125.0 L 139.3 162.5" id="10,9" style="stroke-width:nan"></path><path d="M 157.1 87.5 L 103.6 87.5 L 103.6 125.0" id="12,10" style="stroke-width:nan"></path><path d="M 157.1 87.5 L 210.7 87.5 L 210.7 125.0" id="12,11" style="stroke-width:nan"></path><path d="M 219.6 50.0 L 157.1 50.0 L 157.1 87.5" id="14,12" style="stroke-width:nan"></path><path d="M 219.6 50.0 L 282.1 50.0 L 282.1 87.5" id="14,13" style="stroke-width:nan"></path></g></g><g class="toyplot-mark-Point" id="tb41951952e554ef6a9b88ddf52715f98"><g class="toyplot-Series"><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(50.0, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">0</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(85.71428571428572, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">1</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(67.85714285714286, 162.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">2</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(121.42857142857142, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">3</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(157.1428571428571, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">4</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(139.28571428571428, 162.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">5</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(103.57142857142856, 125.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">6</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(192.85714285714283, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">7</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(228.57142857142856, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">8</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(210.71428571428572, 125.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">9</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(157.1428571428571, 87.5)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">10</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(264.2857142857143, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">11</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(300.0, 200.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">12</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(282.1428571428571, 87.5)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">13</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(219.64285714285717, 50.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">14</text></g></g></g></g></g></g><g class="toyplot-mark-Text" id="t727b97abdb6c4abfa4b78434b345971d"><g class="toyplot-Series"><g class="toyplot-Datum" transform="translate(175.0,20.0)"><text x="-72.368" y="4.087999999999999" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:16.0px;font-weight:normal;opacity:1;stroke:none;vertical-align:baseline;white-space:pre">"postorder" traversal</text></g></g></g></svg><div class="toyplot-behavior"><script>(function()
{
var modules={};
modules["toyplot/tables"] = (function()
    {
        var tables = [];

        var module = {};

        module.set = function(owner, key, names, columns)
        {
            tables.push({owner: owner, key: key, names: names, columns: columns});
        }

        module.get = function(owner, key)
        {
            for(var i = 0; i != tables.length; ++i)
            {
                var table = tables[i];
                if(table.owner != owner)
                    continue;
                if(table.key != key)
                    continue;
                return {names: table.names, columns: table.columns};
            }
        }

        module.get_csv = function(owner, key)
        {
            var table = module.get(owner, key);
            if(table != undefined)
            {
                var csv = "";
                csv += table.names.join(",") + "\n";
                for(var i = 0; i != table.columns[0].length; ++i)
                {
                  for(var j = 0; j != table.columns.length; ++j)
                  {
                    if(j)
                      csv += ",";
                    csv += table.columns[j][i];
                  }
                  csv += "\n";
                }
                return csv;
            }
        }

        return module;
    })();
modules["toyplot/root/id"] = "td56f59eb992640b09c70ba3bf9b103d0";
modules["toyplot/root"] = (function(root_id)
    {
        return document.querySelector("#" + root_id);
    })(modules["toyplot/root/id"]);
modules["toyplot/canvas/id"] = "td377ae4473a54e138eb02c4f266ee3ae";
modules["toyplot/canvas"] = (function(canvas_id)
    {
        return document.querySelector("#" + canvas_id);
    })(modules["toyplot/canvas/id"]);
modules["toyplot/menus/context"] = (function(root, canvas)
    {
        var wrapper = document.createElement("div");
        wrapper.innerHTML = "<ul class='toyplot-context-menu' style='background:#eee; border:1px solid #b8b8b8; border-radius:5px; box-shadow: 0px 0px 8px rgba(0%,0%,0%,0.25); margin:0; padding:3px 0; position:fixed; visibility:hidden;'></ul>"
        var menu = wrapper.firstChild;

        root.appendChild(menu);

        var items = [];

        var ignore_mouseup = null;
        function open_menu(e)
        {
            var show_menu = false;
            for(var index=0; index != items.length; ++index)
            {
                var item = items[index];
                if(item.show(e))
                {
                    item.item.style.display = "block";
                    show_menu = true;
                }
                else
                {
                    item.item.style.display = "none";
                }
            }

            if(show_menu)
            {
                ignore_mouseup = true;
                menu.style.left = (e.clientX + 1) + "px";
                menu.style.top = (e.clientY - 5) + "px";
                menu.style.visibility = "visible";
                e.stopPropagation();
                e.preventDefault();
            }
        }

        function close_menu()
        {
            menu.style.visibility = "hidden";
        }

        function contextmenu(e)
        {
            open_menu(e);
        }

        function mousemove(e)
        {
            ignore_mouseup = false;
        }

        function mouseup(e)
        {
            if(ignore_mouseup)
            {
                ignore_mouseup = false;
                return;
            }
            close_menu();
        }

        function keydown(e)
        {
            if(e.key == "Escape" || e.key == "Esc" || e.keyCode == 27)
            {
                close_menu();
            }
        }

        canvas.addEventListener("contextmenu", contextmenu);
        canvas.addEventListener("mousemove", mousemove);
        document.addEventListener("mouseup", mouseup);
        document.addEventListener("keydown", keydown);

        var module = {};
        module.add_item = function(label, show, activate)
        {
            var wrapper = document.createElement("div");
            wrapper.innerHTML = "<li class='toyplot-context-menu-item' style='background:#eee; color:#333; padding:2px 20px; list-style:none; margin:0; text-align:left;'>" + label + "</li>"
            var item = wrapper.firstChild;

            items.push({item: item, show: show});

            function mouseover()
            {
                this.style.background = "steelblue";
                this.style.color = "white";
            }

            function mouseout()
            {
                this.style.background = "#eee";
                this.style.color = "#333";
            }

            function choose_item(e)
            {
                close_menu();
                activate();

                e.stopPropagation();
                e.preventDefault();
            }

            item.addEventListener("mouseover", mouseover);
            item.addEventListener("mouseout", mouseout);
            item.addEventListener("mouseup", choose_item);
            item.addEventListener("contextmenu", choose_item);

            menu.appendChild(item);
        };
        return module;
    })(modules["toyplot/root"],modules["toyplot/canvas"]);
modules["toyplot/io"] = (function()
    {
        var module = {};
        module.save_file = function(mime_type, charset, data, filename)
        {
            var uri = "data:" + mime_type + ";charset=" + charset + "," + data;
            uri = encodeURI(uri);

            var link = document.createElement("a");
            if(typeof link.download != "undefined")
            {
              link.href = uri;
              link.style = "visibility:hidden";
              link.download = filename;

              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
            }
            else
            {
              window.open(uri);
            }
        };
        return module;
    })();
(function(tables, context_menu, io, owner_id, key, label, names, columns, filename)
        {
            tables.set(owner_id, key, names, columns);

            var owner = document.querySelector("#" + owner_id);
            function show_item(e)
            {
                return owner.contains(e.target);
            }

            function choose_item()
            {
                io.save_file("text/csv", "utf-8", tables.get_csv(owner_id, key), filename + ".csv");
            }

            context_menu.add_item("Save " + label + " as CSV", show_item, choose_item);
        })(modules["toyplot/tables"],modules["toyplot/menus/context"],modules["toyplot/io"],"tb41951952e554ef6a9b88ddf52715f98","data","point",["x", "y0"],[[0.0, 1.0, 0.5, 2.0, 3.0, 2.5, 1.5, 4.0, 5.0, 4.5, 3.0, 6.0, 7.0, 6.5, 4.75], [0.0, 0.0, 0.25, 0.0, 0.0, 0.25, 0.5, 0.0, 0.0, 0.5, 0.75, 0.0, 0.0, 0.75, 1.0]],"toyplot");
})();</script><div class="toyplot-vcr-controls" style="display: none;">
            <input class="toyplot-current-frame" title="Frame" type="range" min="0" max="16" step="1" value="0">
            <button class="toyplot-rewind" title="Rewind" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="10,5 0,10 10,15" stroke="none" fill="#292724"></polygon>
                    <polygon points="20,5 10,10 20,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-reverse-play" title="Reverse Play" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="15,5 5,10 15,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-frame-rewind" title="Frame Rewind" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="15,5 5,10 15,15" stroke="none" fill="#292724"></polygon>
                    <rect x="17" y="5" width="2" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-stop" title="Stop" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <rect x="5" y="5" width="10" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-frame-advance" title="Frame Advance" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="5,5 15,10 5,15" stroke="none" fill="#292724"></polygon>
                    <rect x="1" y="5" width="2" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-forward-play" title="Play" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="5,5 15,10 5,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-fast-forward" title="Fast Forward" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="0,5 10,10 0,15" stroke="none" fill="#292724"></polygon>
                    <polygon points="10,5 20,10 10,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
        </div><script>
        (function()
        {
            var root_id = "td56f59eb992640b09c70ba3bf9b103d0";
            var frame_durations = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5];
            var state_changes = [{"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 0, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 1, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 2, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 3, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 4, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 5, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 6, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 7, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 8, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 9, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 10, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 11, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 12, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 13, "style": {"opacity": 0.1}}, {"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 14, "style": {"opacity": 0.1}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 0, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 1, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 2, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 3, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 4, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 5, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 6, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 7, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 8, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 9, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 10, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 11, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 12, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 13, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "tb41951952e554ef6a9b88ddf52715f98", "series": 0, "datum": 14, "style": {"opacity": 1.0}}]}];

            var current_frame = null;
            var timeout = null;

            function set_timeout(value)
            {
                if(timeout !== null)
                    window.clearTimeout(timeout);
                timeout = value;
            }

            function set_current_frame(frame)
            {
                current_frame = frame;
                document.querySelector("#" + root_id + " .toyplot-current-frame").value = frame;
            }

            function play_reverse()
            {
                set_current_frame((current_frame - 1 + frame_durations.length) % frame_durations.length);
                render_changes(0, current_frame+1)
                set_timeout(window.setTimeout(play_reverse, frame_durations[(current_frame - 1 + frame_durations.length) % frame_durations.length] * 1000));
            }

            function play_forward()
            {
                set_current_frame((current_frame + 1) % frame_durations.length);
                render_changes(current_frame, current_frame+1);
                set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));
            }

            var item_cache = {};
            function get_item(id)
            {
                if(!(id in item_cache))
                    item_cache[id] = document.getElementById(id);
                return item_cache[id];
            }

            function render_changes(begin, end)
            {
                for(var frame = begin; frame != end; ++frame)
                {
                    var changes = state_changes[frame];
                    for(var type in changes)
                    {
                        var states = changes[type]
                        if(type == "set-mark-style")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var mark = get_item(state.mark);
                                for(var key in state.style)
                                {
                                    mark.style.setProperty(key, state[1][key]);
                                }
                            }
                        }
                        else if(type == "set-datum-style")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var datum = get_item(state.mark).querySelectorAll(".toyplot-Series")[state.series].querySelectorAll(".toyplot-Datum")[state.datum];
                                for(var key in state.style)
                                {
                                    datum.style.setProperty(key, state.style[key]);
                                }
                            }
                        }
                        else if(type == "set-datum-text")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var datum = get_item(state.mark).querySelectorAll(".toyplot-Series")[state.series].querySelectorAll(".toyplot-Datum")[state.datum];
                                var layout = document.createElementNS("http://www.w3.org/2000/svg", "g");
                                layout.innerHTML = state.layout;
                                layout = layout.firstChild;

                                while(datum.firstElementChild)
                                    datum.removeChild(datum.firstElementChild);
                                while(layout.firstElementChild)
                                    datum.appendChild(layout.removeChild(layout.firstElementChild));
                            }
                        }
                    }
                }
            }

            function on_set_frame()
            {
            set_timeout(null);
            set_current_frame(document.querySelector("#" + root_id + " .toyplot-current-frame").valueAsNumber);
            render_changes(0, current_frame+1);
            }

            function on_frame_rewind()
            {
            set_timeout(null);
            set_current_frame((current_frame - 1 + frame_durations.length) % frame_durations.length);
            render_changes(0, current_frame+1);
            }

            function on_rewind()
            {
            set_current_frame(0);
            render_changes(0, current_frame+1);
            }

            function on_play_reverse()
            {
            set_timeout(window.setTimeout(play_reverse, frame_durations[(current_frame - 1 + frame_durations.length) % frame_durations.length] * 1000));
            }

            function on_stop()
            {
            set_timeout(null);
            }

            function on_play_forward()
            {
            set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));
            }

            function on_fast_forward()
            {
            set_timeout(null);
            set_current_frame(frame_durations.length - 1);
            render_changes(0, current_frame + 1)
            }

            function on_frame_advance()
            {
            set_timeout(null);
            set_current_frame((current_frame + 1) % frame_durations.length);
            render_changes(current_frame, current_frame+1);
            }

            set_current_frame(0);
            render_changes(0, current_frame+1);
            set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));

            document.querySelector("#" + root_id + " .toyplot-current-frame").oninput = on_set_frame;
            document.querySelector("#" + root_id + " .toyplot-rewind").onclick = on_rewind;
            document.querySelector("#" + root_id + " .toyplot-reverse-play").onclick = on_play_reverse;
            document.querySelector("#" + root_id + " .toyplot-frame-rewind").onclick = on_frame_rewind;
            document.querySelector("#" + root_id + " .toyplot-stop").onclick = on_stop;
            document.querySelector("#" + root_id + " .toyplot-frame-advance").onclick = on_frame_advance;
            document.querySelector("#" + root_id + " .toyplot-forward-play").onclick = on_play_forward;
            document.querySelector("#" + root_id + " .toyplot-fast-forward").onclick = on_fast_forward;
        })();
        </script></div></div>

<!-- 
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
 -->

<h4 id="idxorder-traversal"><em>idxorder</em> traversal<a class="headerlink" href="#idxorder-traversal" title="Permanent link">&para;</a></h4>
<p>This is a custom traversal order used by <code>toytree</code>. It could similarly be
called "tips-first-then-postorder" traversal, because it works by first 
visiting the tip Nodes from left to right, and then proceeds by visiting 
internal nodes in a postorder manner (left then right subtrees, then their
parent). This traversal strategy turns out be particularly convenient for
working with phylogenetic trees, since the tip Nodes represent the actual
extant samples in our dataset, and are therefore usually of greatest interest.
This traversal thus makes it easier to select and find the tip Nodes by knowing
that the first N Nodes in a tree will be the tips.</p>
<div class="toyplot" id="ta1efdb8c9418465db6c7938c6a4a0b36" style="text-align:center"><svg class="toyplot-canvas-Canvas" xmlns:toyplot="http://www.sandia.gov/toyplot" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" width="350.0px" height="250.0px" viewBox="0 0 350.0 250.0" preserveAspectRatio="xMidYMid meet" style="background-color:white;border-color:#292724;border-style:none;border-width:1.0;fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:Helvetica;font-size:12px;opacity:1.0;stroke:rgb(16.1%,15.3%,14.1%);stroke-opacity:1.0;stroke-width:1.0" id="t9291e9588bf54aed9e4a404013a1c7c9"><g class="toyplot-coordinates-Cartesian" id="tfa0e71fd7e6849048234fb586b7c9f7c"><clipPath id="t6abdddba0153401b9ed13beae063a58b"><rect x="35.0" y="35.0" width="280.0" height="180.0"></rect></clipPath><g clip-path="url(#t6abdddba0153401b9ed13beae063a58b)"><g class="toytree-mark-Toytree" id="t13ec9ed0be74488a871a3e04b0bb91fe"><g class="toytree-Edges" style="fill:none;stroke:rgba(16.1%,15.3%,14.1%,1.000);stroke-linecap:round;stroke-width:2.0"><path d="M 67.9 162.5 L 50.0 162.5 L 50.0 200.0" id="8,0" style="stroke-width:nan"></path><path d="M 67.9 162.5 L 85.7 162.5 L 85.7 200.0" id="8,1" style="stroke-width:nan"></path><path d="M 139.3 162.5 L 121.4 162.5 L 121.4 200.0" id="9,2" style="stroke-width:nan"></path><path d="M 139.3 162.5 L 157.1 162.5 L 157.1 200.0" id="9,3" style="stroke-width:nan"></path><path d="M 210.7 125.0 L 192.9 125.0 L 192.9 200.0" id="11,4" style="stroke-width:nan"></path><path d="M 210.7 125.0 L 228.6 125.0 L 228.6 200.0" id="11,5" style="stroke-width:nan"></path><path d="M 282.1 87.5 L 264.3 87.5 L 264.3 200.0" id="13,6" style="stroke-width:nan"></path><path d="M 282.1 87.5 L 300.0 87.5 L 300.0 200.0" id="13,7" style="stroke-width:nan"></path><path d="M 103.6 125.0 L 67.9 125.0 L 67.9 162.5" id="10,8" style="stroke-width:nan"></path><path d="M 103.6 125.0 L 139.3 125.0 L 139.3 162.5" id="10,9" style="stroke-width:nan"></path><path d="M 157.1 87.5 L 103.6 87.5 L 103.6 125.0" id="12,10" style="stroke-width:nan"></path><path d="M 157.1 87.5 L 210.7 87.5 L 210.7 125.0" id="12,11" style="stroke-width:nan"></path><path d="M 219.6 50.0 L 157.1 50.0 L 157.1 87.5" id="14,12" style="stroke-width:nan"></path><path d="M 219.6 50.0 L 282.1 50.0 L 282.1 87.5" id="14,13" style="stroke-width:nan"></path></g></g><g class="toyplot-mark-Point" id="t1697f89c4fa74386baf33f35e771df06"><g class="toyplot-Series"><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(50.0, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">0</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(85.71428571428572, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">1</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(121.42857142857142, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">2</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(157.1428571428571, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">3</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(192.85714285714283, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">4</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(228.57142857142856, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">5</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(264.2857142857143, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">6</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(300.0, 200.0)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">7</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(67.85714285714286, 162.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">8</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(139.28571428571428, 162.5)"><circle r="10.0"></circle><g><text x="-4.170000000000001" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">9</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(103.57142857142856, 125.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">10</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(210.71428571428572, 125.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">11</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(157.1428571428571, 87.5)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">12</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(282.1428571428571, 87.5)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">13</text></g></g><g style="fill:rgb(40%,76.1%,64.7%);fill-opacity:1.0;opacity:1.0;stroke:rgb(40%,76.1%,64.7%);stroke-opacity:1.0" class="toyplot-Datum" transform="translate(219.64285714285717, 50.0)"><circle r="10.0"></circle><g><text x="-8.340000000000002" y="3.8324999999999996" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:15.0px;font-weight:normal;stroke:none;vertical-align:baseline;white-space:pre">14</text></g></g></g></g></g></g><g class="toyplot-mark-Text" id="t9810adad2af84f6690cdfaaf379f0138"><g class="toyplot-Series"><g class="toyplot-Datum" transform="translate(175.0,20.0)"><text x="-67.47200000000001" y="4.087999999999999" style="fill:rgb(16.1%,15.3%,14.1%);fill-opacity:1.0;font-family:helvetica;font-size:16.0px;font-weight:normal;opacity:1;stroke:none;vertical-align:baseline;white-space:pre">"idxorder" traversal</text></g></g></g></svg><div class="toyplot-behavior"><script>(function()
{
var modules={};
modules["toyplot/tables"] = (function()
    {
        var tables = [];

        var module = {};

        module.set = function(owner, key, names, columns)
        {
            tables.push({owner: owner, key: key, names: names, columns: columns});
        }

        module.get = function(owner, key)
        {
            for(var i = 0; i != tables.length; ++i)
            {
                var table = tables[i];
                if(table.owner != owner)
                    continue;
                if(table.key != key)
                    continue;
                return {names: table.names, columns: table.columns};
            }
        }

        module.get_csv = function(owner, key)
        {
            var table = module.get(owner, key);
            if(table != undefined)
            {
                var csv = "";
                csv += table.names.join(",") + "\n";
                for(var i = 0; i != table.columns[0].length; ++i)
                {
                  for(var j = 0; j != table.columns.length; ++j)
                  {
                    if(j)
                      csv += ",";
                    csv += table.columns[j][i];
                  }
                  csv += "\n";
                }
                return csv;
            }
        }

        return module;
    })();
modules["toyplot/root/id"] = "ta1efdb8c9418465db6c7938c6a4a0b36";
modules["toyplot/root"] = (function(root_id)
    {
        return document.querySelector("#" + root_id);
    })(modules["toyplot/root/id"]);
modules["toyplot/canvas/id"] = "t9291e9588bf54aed9e4a404013a1c7c9";
modules["toyplot/canvas"] = (function(canvas_id)
    {
        return document.querySelector("#" + canvas_id);
    })(modules["toyplot/canvas/id"]);
modules["toyplot/menus/context"] = (function(root, canvas)
    {
        var wrapper = document.createElement("div");
        wrapper.innerHTML = "<ul class='toyplot-context-menu' style='background:#eee; border:1px solid #b8b8b8; border-radius:5px; box-shadow: 0px 0px 8px rgba(0%,0%,0%,0.25); margin:0; padding:3px 0; position:fixed; visibility:hidden;'></ul>"
        var menu = wrapper.firstChild;

        root.appendChild(menu);

        var items = [];

        var ignore_mouseup = null;
        function open_menu(e)
        {
            var show_menu = false;
            for(var index=0; index != items.length; ++index)
            {
                var item = items[index];
                if(item.show(e))
                {
                    item.item.style.display = "block";
                    show_menu = true;
                }
                else
                {
                    item.item.style.display = "none";
                }
            }

            if(show_menu)
            {
                ignore_mouseup = true;
                menu.style.left = (e.clientX + 1) + "px";
                menu.style.top = (e.clientY - 5) + "px";
                menu.style.visibility = "visible";
                e.stopPropagation();
                e.preventDefault();
            }
        }

        function close_menu()
        {
            menu.style.visibility = "hidden";
        }

        function contextmenu(e)
        {
            open_menu(e);
        }

        function mousemove(e)
        {
            ignore_mouseup = false;
        }

        function mouseup(e)
        {
            if(ignore_mouseup)
            {
                ignore_mouseup = false;
                return;
            }
            close_menu();
        }

        function keydown(e)
        {
            if(e.key == "Escape" || e.key == "Esc" || e.keyCode == 27)
            {
                close_menu();
            }
        }

        canvas.addEventListener("contextmenu", contextmenu);
        canvas.addEventListener("mousemove", mousemove);
        document.addEventListener("mouseup", mouseup);
        document.addEventListener("keydown", keydown);

        var module = {};
        module.add_item = function(label, show, activate)
        {
            var wrapper = document.createElement("div");
            wrapper.innerHTML = "<li class='toyplot-context-menu-item' style='background:#eee; color:#333; padding:2px 20px; list-style:none; margin:0; text-align:left;'>" + label + "</li>"
            var item = wrapper.firstChild;

            items.push({item: item, show: show});

            function mouseover()
            {
                this.style.background = "steelblue";
                this.style.color = "white";
            }

            function mouseout()
            {
                this.style.background = "#eee";
                this.style.color = "#333";
            }

            function choose_item(e)
            {
                close_menu();
                activate();

                e.stopPropagation();
                e.preventDefault();
            }

            item.addEventListener("mouseover", mouseover);
            item.addEventListener("mouseout", mouseout);
            item.addEventListener("mouseup", choose_item);
            item.addEventListener("contextmenu", choose_item);

            menu.appendChild(item);
        };
        return module;
    })(modules["toyplot/root"],modules["toyplot/canvas"]);
modules["toyplot/io"] = (function()
    {
        var module = {};
        module.save_file = function(mime_type, charset, data, filename)
        {
            var uri = "data:" + mime_type + ";charset=" + charset + "," + data;
            uri = encodeURI(uri);

            var link = document.createElement("a");
            if(typeof link.download != "undefined")
            {
              link.href = uri;
              link.style = "visibility:hidden";
              link.download = filename;

              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
            }
            else
            {
              window.open(uri);
            }
        };
        return module;
    })();
(function(tables, context_menu, io, owner_id, key, label, names, columns, filename)
        {
            tables.set(owner_id, key, names, columns);

            var owner = document.querySelector("#" + owner_id);
            function show_item(e)
            {
                return owner.contains(e.target);
            }

            function choose_item()
            {
                io.save_file("text/csv", "utf-8", tables.get_csv(owner_id, key), filename + ".csv");
            }

            context_menu.add_item("Save " + label + " as CSV", show_item, choose_item);
        })(modules["toyplot/tables"],modules["toyplot/menus/context"],modules["toyplot/io"],"t1697f89c4fa74386baf33f35e771df06","data","point",["x", "y0"],[[0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 0.5, 2.5, 1.5, 4.5, 3.0, 6.5, 4.75], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.25, 0.25, 0.5, 0.5, 0.75, 0.75, 1.0]],"toyplot");
})();</script><div class="toyplot-vcr-controls" style="display: none;">
            <input class="toyplot-current-frame" title="Frame" type="range" min="0" max="16" step="1" value="0">
            <button class="toyplot-rewind" title="Rewind" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="10,5 0,10 10,15" stroke="none" fill="#292724"></polygon>
                    <polygon points="20,5 10,10 20,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-reverse-play" title="Reverse Play" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="15,5 5,10 15,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-frame-rewind" title="Frame Rewind" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="15,5 5,10 15,15" stroke="none" fill="#292724"></polygon>
                    <rect x="17" y="5" width="2" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-stop" title="Stop" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <rect x="5" y="5" width="10" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-frame-advance" title="Frame Advance" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="5,5 15,10 5,15" stroke="none" fill="#292724"></polygon>
                    <rect x="1" y="5" width="2" height="10" stroke="none" fill="#292724"></rect>
                </svg>
            </button>
            <button class="toyplot-forward-play" title="Play" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="5,5 15,10 5,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
            <button class="toyplot-fast-forward" title="Fast Forward" style="width:40px;height:24px">
                <svg width="20" height="20">
                    <polygon points="0,5 10,10 0,15" stroke="none" fill="#292724"></polygon>
                    <polygon points="10,5 20,10 10,15" stroke="none" fill="#292724"></polygon>
                </svg>
            </button>
        </div><script>
        (function()
        {
            var root_id = "ta1efdb8c9418465db6c7938c6a4a0b36";
            var frame_durations = [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5];
            var state_changes = [{"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 0, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 1, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 2, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 3, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 4, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 5, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 6, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 7, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 8, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 9, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 10, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 11, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 12, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 13, "style": {"opacity": 0.1}}, {"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 14, "style": {"opacity": 0.1}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 0, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 1, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 2, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 3, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 4, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 5, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 6, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 7, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 8, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 9, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 10, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 11, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 12, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 13, "style": {"opacity": 1.0}}]}, {"set-datum-style": [{"mark": "t1697f89c4fa74386baf33f35e771df06", "series": 0, "datum": 14, "style": {"opacity": 1.0}}]}];

            var current_frame = null;
            var timeout = null;

            function set_timeout(value)
            {
                if(timeout !== null)
                    window.clearTimeout(timeout);
                timeout = value;
            }

            function set_current_frame(frame)
            {
                current_frame = frame;
                document.querySelector("#" + root_id + " .toyplot-current-frame").value = frame;
            }

            function play_reverse()
            {
                set_current_frame((current_frame - 1 + frame_durations.length) % frame_durations.length);
                render_changes(0, current_frame+1)
                set_timeout(window.setTimeout(play_reverse, frame_durations[(current_frame - 1 + frame_durations.length) % frame_durations.length] * 1000));
            }

            function play_forward()
            {
                set_current_frame((current_frame + 1) % frame_durations.length);
                render_changes(current_frame, current_frame+1);
                set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));
            }

            var item_cache = {};
            function get_item(id)
            {
                if(!(id in item_cache))
                    item_cache[id] = document.getElementById(id);
                return item_cache[id];
            }

            function render_changes(begin, end)
            {
                for(var frame = begin; frame != end; ++frame)
                {
                    var changes = state_changes[frame];
                    for(var type in changes)
                    {
                        var states = changes[type]
                        if(type == "set-mark-style")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var mark = get_item(state.mark);
                                for(var key in state.style)
                                {
                                    mark.style.setProperty(key, state[1][key]);
                                }
                            }
                        }
                        else if(type == "set-datum-style")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var datum = get_item(state.mark).querySelectorAll(".toyplot-Series")[state.series].querySelectorAll(".toyplot-Datum")[state.datum];
                                for(var key in state.style)
                                {
                                    datum.style.setProperty(key, state.style[key]);
                                }
                            }
                        }
                        else if(type == "set-datum-text")
                        {
                            for(var i = 0; i != states.length; ++i)
                            {
                                var state = states[i];
                                var datum = get_item(state.mark).querySelectorAll(".toyplot-Series")[state.series].querySelectorAll(".toyplot-Datum")[state.datum];
                                var layout = document.createElementNS("http://www.w3.org/2000/svg", "g");
                                layout.innerHTML = state.layout;
                                layout = layout.firstChild;

                                while(datum.firstElementChild)
                                    datum.removeChild(datum.firstElementChild);
                                while(layout.firstElementChild)
                                    datum.appendChild(layout.removeChild(layout.firstElementChild));
                            }
                        }
                    }
                }
            }

            function on_set_frame()
            {
            set_timeout(null);
            set_current_frame(document.querySelector("#" + root_id + " .toyplot-current-frame").valueAsNumber);
            render_changes(0, current_frame+1);
            }

            function on_frame_rewind()
            {
            set_timeout(null);
            set_current_frame((current_frame - 1 + frame_durations.length) % frame_durations.length);
            render_changes(0, current_frame+1);
            }

            function on_rewind()
            {
            set_current_frame(0);
            render_changes(0, current_frame+1);
            }

            function on_play_reverse()
            {
            set_timeout(window.setTimeout(play_reverse, frame_durations[(current_frame - 1 + frame_durations.length) % frame_durations.length] * 1000));
            }

            function on_stop()
            {
            set_timeout(null);
            }

            function on_play_forward()
            {
            set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));
            }

            function on_fast_forward()
            {
            set_timeout(null);
            set_current_frame(frame_durations.length - 1);
            render_changes(0, current_frame + 1)
            }

            function on_frame_advance()
            {
            set_timeout(null);
            set_current_frame((current_frame + 1) % frame_durations.length);
            render_changes(current_frame, current_frame+1);
            }

            set_current_frame(0);
            render_changes(0, current_frame+1);
            set_timeout(window.setTimeout(play_forward, frame_durations[current_frame] * 1000));

            document.querySelector("#" + root_id + " .toyplot-current-frame").oninput = on_set_frame;
            document.querySelector("#" + root_id + " .toyplot-rewind").onclick = on_rewind;
            document.querySelector("#" + root_id + " .toyplot-reverse-play").onclick = on_play_reverse;
            document.querySelector("#" + root_id + " .toyplot-frame-rewind").onclick = on_frame_rewind;
            document.querySelector("#" + root_id + " .toyplot-stop").onclick = on_stop;
            document.querySelector("#" + root_id + " .toyplot-frame-advance").onclick = on_frame_advance;
            document.querySelector("#" + root_id + " .toyplot-forward-play").onclick = on_play_forward;
            document.querySelector("#" + root_id + " .toyplot-fast-forward").onclick = on_fast_forward;
        })();
        </script></div></div>

<!-- 
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
##############################################################################
 -->

<h2 id="coding-node-traversals">Coding Node Traversals<a class="headerlink" href="#coding-node-traversals" title="Permanent link">&para;</a></h2>
<p>Now that you have seen several traversal strategies, we can implement them
as methods of our <code>Node</code> class object. In fact, the final <code>Node</code> class that
we have developed below is pretty similar to the <code>Node</code> class that is used
under the hood in the <code>toytree</code> library. You can 
expand the collapsable code block below to see the entire new <code>Node</code> class
definition that now includes several new functions. Browse through this 
slowly to try to understand how it works. Don't worry if it seems a bit 
much, we will break it down into parts below.</p>
<details class="example">
<summary>Full Node class definition (w/ traversal functions and more)</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Iterator</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="k">class</span> <span class="nc">Node</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A Node instance that can connect with other Nodes to form a Tree.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name: str</span>
<span class="sd">        A name string associated with a Node when printed or visualized.</span>
<span class="sd">    dist: float</span>
<span class="sd">        A float value as the distance between this Node and its parent (up)</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    children: Tuple</span>
<span class="sd">        A tuple of Node instances that are descended from this Node.</span>
<span class="sd">    up: Node or None</span>
<span class="sd">        A Node that is ancestral to this Node, or None if this Node is root.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; node = Node(&quot;A&quot;)</span>
<span class="sd">    &gt;&gt;&gt; node.add_child(&quot;B&quot;)</span>
<span class="sd">    &gt;&gt;&gt; print(node.name, node.children)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return string representation as Node(name).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Node(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="nf">is_leaf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if Node is a leaf (i.e., has no children).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if Node is the root (i.e., has no ancestor).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">up</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_child</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">dist</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Node&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add a Node as a child to this one.&quot;&quot;&quot;</span>
        <span class="n">new_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">dist</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span>
        <span class="n">new_node</span><span class="o">.</span><span class="n">up</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">children</span> <span class="o">+=</span> <span class="p">(</span><span class="n">new_node</span><span class="p">,)</span>
        <span class="k">return</span> <span class="n">new_node</span>

    <span class="c1">############################################################</span>
    <span class="c1">## TRAVERSAL FUNCTIONS                                    ##</span>
    <span class="c1">############################################################</span>

    <span class="k">def</span> <span class="nf">traverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;levelorder&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a generator over all Nodes using a tree traversal strategy.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        strategy: str</span>
<span class="sd">            A traversal strategy for the order in which nodes will</span>
<span class="sd">            be visited: &#39;preorder&#39;, &#39;postorder&#39;, &#39;levelorder&#39;,</span>
<span class="sd">            &#39;inorder&#39;, or &#39;idxorder&#39;.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        preorder:</span>
<span class="sd">            Parents are visited before children. Traverses all the way</span>
<span class="sd">            down each left subtree before backtracking to right subtree.</span>
<span class="sd">        postorder:</span>
<span class="sd">            Children are visited before parents. The left subtree is</span>
<span class="sd">            visited, then right, then the parent.</span>
<span class="sd">        levelorder:</span>
<span class="sd">            Nodes the same depth from root are visited left to</span>
<span class="sd">            right, before descending to next level.</span>
<span class="sd">        idxorder:</span>
<span class="sd">            Leaf nodes are visited left to right, followed by internal</span>
<span class="sd">            nodes in postorder traversal order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;preorder&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_traverse_preorder</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;levelorder&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_traverse_levelorder</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;postorder&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_traverse_postorder</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">strategy</span> <span class="o">==</span> <span class="s2">&quot;idxorder&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_traverse_idxorder</span><span class="p">()</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;strategy </span><span class="si">{</span><span class="n">strategy</span><span class="si">}</span><span class="s2"> is not a supported traversal algorithm&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_traverse_preorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all nodes by &#39;preorder&#39; traversal.&quot;&quot;&quot;</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">yield</span> <span class="n">node</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_traverse_levelorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all desdecendant nodes in levelorder.&quot;&quot;&quot;</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">yield</span> <span class="n">node</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_traverse_postorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all descendant nodes in tip-to-root order.&quot;&quot;&quot;</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="c1"># get node from queue and add to the output stack</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="c1"># add node&#39;s children to the queue</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
        <span class="c1"># yield nodes in reverse order they were added to stack</span>
        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_traverse_idxorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterates over all nodes in &#39;idx&#39; order.&quot;&quot;&quot;</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="n">inner_stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">outer_stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>

            <span class="c1"># get node from end of the queue</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

            <span class="c1"># if node is leaf insert to output stack ntips from right</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
                <span class="n">outer_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

            <span class="c1"># if not leaf then insert to output stack...</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">inner_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

            <span class="c1"># add node&#39;s children to the queue</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>

        <span class="c1"># return nodes in reverse order they were added to stack</span>
        <span class="k">while</span> <span class="n">outer_stack</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">outer_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">inner_stack</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">inner_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

    <span class="c1">######################################################</span>
    <span class="c1">## LEAF AND NAME RETRIEVAL                          ##</span>
    <span class="c1">######################################################</span>

    <span class="k">def</span> <span class="nf">_iter_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator of leaves descended from this node in</span>
<span class="sd">        idxorder.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;idxorder&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">get_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of leaf nodes descended from this node in</span>
<span class="sd">        idxorder.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_leaves</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_iter_leaf_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator of names of Nodes descended from this</span>
<span class="sd">        node in idxorder.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_leaves</span><span class="p">():</span>
            <span class="k">yield</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">get_leaf_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of names of Nodes descended from this node</span>
<span class="sd">        in idxorder.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_leaf_names</span><span class="p">())</span>

    <span class="c1">#################################################</span>
    <span class="c1">## NODE RELATIVE RETRIEVAL / TRAVERSAL</span>
    <span class="c1">#################################################</span>

    <span class="k">def</span> <span class="nf">_iter_sisters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator to iterate over sister nodes.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">child</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">child</span>

    <span class="k">def</span> <span class="nf">get_sisters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return list of other Nodes that are children of same parent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_sisters</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_iter_descendants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;levelorder&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator of descendant Nodes (not including self).&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">get_descendants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;levelorder&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of descendant Nodes (not including self).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_descendants</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_iter_ancestors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator of Nodes on path from this node to root.&quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">up</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">get_ancestors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of Nodes on path from this node to root.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_ancestors</span><span class="p">())</span>            
</code></pre></div></td></tr></table></div>
</details>
<p>The new sections of the code are located below a commented block that 
says "## TRAVERSAL FUNCTIONS". I'll briefly describe each of these functions
in turn, referring to them by name and by line numbers. </p>
<ul>
<li>
<p><code class="highlight"><span class="n">traverse</span><span class="p">()</span></code> (lines 56-90): This is a simple function that takes a traversal strategy
name as a string and then calls one of the several possible traversal 
functions that are defined below it. The purpose of this function is simply
to provide a single function that users can interface with to select a 
traversal strategy, and where a single documentation string can provide a lot
of detail on the methods that are available. You'll notice that the other
functions have names that start with an underscore, such as 
 <code class="highlight"><span class="n">_traverse_preorder</span><span class="p">()</span></code>. These are called <em>private functions</em>. This
is simply a convention in Python for naming functions that are not intended to 
be called by users. By starting the name with an underscore this ensures it 
will not show up by default during tab auto-completion in interactive environments
like jupyter, and thus users will usually see just <code>traverse()</code> and not the 
private functions that <code>traverse()</code> is intended to call.</p>
</li>
<li>
<p><code class="highlight"><span class="n">_traverse_preorder</span><span class="p">()</span></code> (lines 92-98): This 
is one of the simplest traversal algorithms to code, and the one that we 
used for demonstration already earlier in this chapter. 
Starting from the root Node, a list is created (line 94) to hold the Nodes 
that should be yielded from next. A while loop runs until all Nodes are 
processed (line 95). Each iteration the last Node in the queue is
<code>pop</code>'ed (removed) and yielded (lines 96-97). If the Node has any children, 
they are added to the queue to be processed next, with the left child placed 
at the right end of the queue so it will be yielded before the right child
(line 98).</p>
</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">_traverse_preorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all nodes by &#39;preorder&#39; traversal.&quot;&quot;&quot;</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">yield</span> <span class="n">node</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
<ul>
<li><code class="highlight"><span class="n">_traverse_levelorder</span><span class="p">()</span></code> (lines 100-106): This function is similar
to <em>preorder</em> traversal, and differs in code only in that we use a new type
of object called a <code>deque</code> that is imported from the Python standard library
module <code>collections</code>. This is a double-ended queue, which is similar to a 
list but can append or pop from either end, instead of just the right side.
So we use the <code>deque</code> as a queue this time, and <code>pop</code> Nodes from the left
side of it (line 107), while new child Nodes are still added to the right 
end (line 109). This ensures that Nodes are yielded in the order of their 
depth from the root.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">_traverse_levelorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all desdecendant nodes in levelorder.&quot;&quot;&quot;</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="bp">self</span><span class="p">])</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">popleft</span><span class="p">()</span>
            <span class="k">yield</span> <span class="n">node</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<ul>
<li><code class="highlight"><span class="n">_traverse_postorder</span><span class="p">()</span></code> (lines 108-120): This function is similar
to <em>preorder</em> traversal, but differs in an important way. It requires the 
use of an additional list to be used as a stack to store the order that
Nodes will eventually be yielded (line 111). Instead of yielding Nodes as
they are first popped from the queue (line 114), they are instead added to 
the stack (line 115). Only after the stack is full is it unpacked and Nodes
are yielded one at a time in postorder (lines 119-120). The use of this 
additional stack makes this traversal method slightly slower and much less
memory efficient than the first two methods. This trade-off is required, 
however, to provide the fastest option for yielding Nodes in reverse 
topological sort, where children come before parents.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">_traverse_postorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterate over all descendant nodes in tip-to-root order.&quot;&quot;&quot;</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
            <span class="c1"># get node from queue and add to the output stack</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
            <span class="c1"># add node&#39;s children to the queue</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
        <span class="c1"># yield nodes in reverse order they were added to stack</span>
        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<ul>
<li><code class="highlight"><span class="n">_traverse_idxorder</span><span class="p">()</span></code> (lines 122-48): This function is similar
to <em>postorder</em> traversal in that it returns tip Nodes before internal Nodes
and therefore requires the use of an additional stack. It uses two separate
stacks, one for tips and one for internal Nodes, and yields from these 
in order, so that tips are yielded first from left to right, followed by 
internal Nodes in postorder traversal.</li>
</ul>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span> <span class="nf">_traverse_idxorder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Iterates over all nodes in &#39;idx&#39; order.&quot;&quot;&quot;</span>
        <span class="n">queue</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
        <span class="n">inner_stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">outer_stack</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>

            <span class="c1"># get node from end of the queue</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

            <span class="c1"># if node is leaf insert to output stack ntips from right</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
                <span class="n">outer_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

            <span class="c1"># if not leaf then insert to output stack...</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">inner_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

            <span class="c1"># add node&#39;s children to the queue</span>
            <span class="n">queue</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>

        <span class="c1"># return nodes in reverse order they were added to stack</span>
        <span class="k">while</span> <span class="n">outer_stack</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">outer_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">while</span> <span class="n">inner_stack</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">inner_stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
<h2 id="using-traversals">Using Traversals<a class="headerlink" href="#using-traversals" title="Permanent link">&para;</a></h2>
<p>Finally, let's now explore the use of our Node traversal functions. As we 
have seen already, we can print the order of the Nodes, which is interesting, 
but not yet very useful. In addition to this, the next two sections 
demonstrate some more useful applications of traversals for extracting 
information about the tree or measuring statistics on a tree. </p>
<p><div class="highlight"><pre><span></span><code><span class="c1"># get a random 10-tip tree of connected Nodes</span>
<span class="n">root_node</span> <span class="o">=</span> <span class="n">get_random_tree</span><span class="p">(</span><span class="n">ntips</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># print Nodes in each traversal order</span>
<span class="k">for</span> <span class="n">strategy</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;levelorder&quot;</span><span class="p">,</span> <span class="s2">&quot;postorder&quot;</span><span class="p">,</span> <span class="s2">&quot;preorder&quot;</span><span class="p">,</span> <span class="s2">&quot;idxorder&quot;</span><span class="p">]:</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">root_node</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">strategy</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">order</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># levelorder [Node(root), Node(left1), Node(right1), Node(left3), Node(right3), Node(left2), Node(right2), Node(left5), Node(right5), Node(left4), Node(right4)]</span>
<span class="c1"># postorder [Node(left5), Node(right5), Node(left3), Node(left4), Node(right4), Node(right3), Node(left1), Node(left2), Node(right2), Node(right1), Node(root)]</span>
<span class="c1"># preorder [Node(root), Node(left1), Node(left3), Node(left5), Node(right5), Node(right3), Node(left4), Node(right4), Node(right1), Node(left2), Node(right2)]</span>
<span class="c1"># idxorder [Node(left5), Node(right5), Node(left4), Node(right4), Node(left2), Node(right2), Node(left3), Node(right3), Node(left1), Node(right1), Node(root)]</span>
</code></pre></div></p>
<h3 id="leaf-and-name-retrieval">Leaf and Name Retrieval<a class="headerlink" href="#leaf-and-name-retrieval" title="Permanent link">&para;</a></h3>
<p>The new Node object includes a section starting at line 150 defining several
functions for accessng information about leaf Nodes and their names. This 
is a frequent way to interrogate parts of a tree, by asking which tips are
descended from a given Node. A style choice was made in the design of this
<code>Node</code> class to write the generator functions as private functions (starting 
with an underscore) and to make a public versions of each that return the 
fully built collection as a tuple. I write it this way here to show that it
is the same way in <code>toytree</code>. The generator functions are available if you 
know about them, but because most non-power-users do not need to use iteration, 
the alternative methods are less scary and easier to use. The code below is 
very easy to write and understand, since converting generators to tuples 
is very simple.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="c1">######################################################</span>
    <span class="c1">## LEAF AND NAME RETRIEVAL                          ##</span>
    <span class="c1">######################################################</span>

    <span class="k">def</span> <span class="nf">_iter_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator of leaves descended from this node in</span>
<span class="sd">        idxorder.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;idxorder&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">get_leaves</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of leaf nodes descended from this node in</span>
<span class="sd">        idxorder.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_leaves</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_iter_leaf_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator of names of Nodes descended from this</span>
<span class="sd">        node in idxorder.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iter_leaves</span><span class="p">():</span>
            <span class="k">yield</span> <span class="n">node</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">get_leaf_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of names of Nodes descended from this node</span>
<span class="sd">        in idxorder.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_leaf_names</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
<p><div class="highlight"><pre><span></span><code><span class="c1"># example: print each Node and its descendants</span>
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">root_node</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="s2">&quot;levelorder&quot;</span><span class="p">):</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_leaf_names</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">:</span><span class="se">\t</span><span class="s2">tips=</span><span class="si">{</span><span class="n">names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Node(root):     tips=(&#39;left5&#39;, &#39;right5&#39;, &#39;left4&#39;, &#39;right4&#39;, &#39;left2&#39;, &#39;right2&#39;)</span>
<span class="c1"># Node(left1):    tips=(&#39;left5&#39;, &#39;right5&#39;, &#39;left4&#39;, &#39;right4&#39;)</span>
<span class="c1"># Node(right1):   tips=(&#39;left2&#39;, &#39;right2&#39;)</span>
<span class="c1"># Node(left3):    tips=(&#39;left5&#39;, &#39;right5&#39;)</span>
<span class="c1"># Node(right3):   tips=(&#39;left4&#39;, &#39;right4&#39;)</span>
<span class="c1"># Node(left2):    tips=(&#39;left2&#39;,)</span>
<span class="c1"># Node(right2):   tips=(&#39;right2&#39;,)</span>
<span class="c1"># Node(left5):    tips=(&#39;left5&#39;,)</span>
<span class="c1"># Node(right5):   tips=(&#39;right5&#39;,)</span>
<span class="c1"># Node(left4):    tips=(&#39;left4&#39;,)</span>
<span class="c1"># Node(right4):   tips=(&#39;right4&#39;,)</span>
</code></pre></div></p>
<h3 id="node-relationships">Node Relationships<a class="headerlink" href="#node-relationships" title="Permanent link">&para;</a></h3>
<p>The relationships among Nodes can also be retrieved using simple operations
involving traversal, and the up and children attributes of Nodes. These 
functions are also available from <code>Node</code> class objects in <code>toytree</code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="c1">#################################################</span>
    <span class="c1">## NODE RELATIVE RETRIEVAL / TRAVERSAL</span>
    <span class="c1">#################################################</span>

    <span class="k">def</span> <span class="nf">_iter_sisters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator to iterate over sister nodes.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">up</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">child</span> <span class="o">!=</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">child</span>

    <span class="k">def</span> <span class="nf">get_sisters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return list of other Nodes that are children of same parent.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_sisters</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_iter_descendants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;levelorder&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator of descendant Nodes (not including self).&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">get_descendants</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strategy</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;levelorder&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of descendant Nodes (not including self).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_descendants</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="n">strategy</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_iter_ancestors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a Generator of Nodes on path from this node to root.&quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">while</span> <span class="n">node</span><span class="o">.</span><span class="n">up</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">node</span>

    <span class="k">def</span> <span class="nf">get_ancestors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of Nodes on path from this node to root.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_iter_ancestors</span><span class="p">())</span>            
</code></pre></div></td></tr></table></div>
<h3 id="preorder-usage">Preorder usage<a class="headerlink" href="#preorder-usage" title="Permanent link">&para;</a></h3>
<p>The <em>preorder</em> traversal can be useful for calculating metrics that require
information about the parents. For example, we could write the function 
below to count the depth of every Node (number of Nodes it is away from the root). At each
Node instead of having to measure the distance independently to the root, 
it can simply fetch the value already calculated for its parent, and then
just add 1. A simple function is written below that uses <em>preorder</em> traversal
and returns the result as a dict. Having a traversal function makes this very easy to code.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>

<span class="k">def</span> <span class="nf">get_node_depths</span><span class="p">(</span><span class="n">root_node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield tuple of (Node, int) with depths of each Node from the root.&quot;&quot;&quot;</span>
    <span class="n">depths</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">root_node</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="s2">&quot;preorder&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_root</span><span class="p">():</span>
            <span class="n">depths</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">depths</span><span class="p">[</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">depths</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">up</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">depths</span>

<span class="c1"># example</span>
<span class="n">root_node</span> <span class="o">=</span> <span class="n">get_random_tree</span><span class="p">(</span><span class="n">ntips</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="n">get_node_depths</span><span class="p">(</span><span class="n">root_node</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># {Node(root): 0,</span>
<span class="c1">#  Node(left1): 1,</span>
<span class="c1">#  Node(left3): 2,</span>
<span class="c1">#  Node(left5): 3,</span>
<span class="c1">#  Node(right5): 3,</span>
<span class="c1">#  Node(right3): 2,</span>
<span class="c1">#  Node(left4): 3,</span>
<span class="c1">#  Node(right4): 3,</span>
<span class="c1">#  Node(right1): 1,</span>
<span class="c1">#  Node(left2): 2,</span>
<span class="c1">#  Node(right2): 2}</span>
</code></pre></div>
<h3 id="postorder-usage">Postorder usage<a class="headerlink" href="#postorder-usage" title="Permanent link">&para;</a></h3>
<p>The <em>postorder</em> traversal is particularly powerful for counting metrics 
over Nodes, or other operations that require operating first on the children
before the parents. An example is calculating the number of descendants 
of each Node. We could use one of our earlier functions such as 
<code>get_descendants</code> to count the number at each Node, but that would involve
calling a new traversal at every single Node (slow). A much faster operation can be
done by using only a single traversal in postorder. In this case, each Node 
simply takes the value of one of its children and then adds to it its own number of 
children. </p>
<p>In contrast to the last function which filled and returned a dict
object, I wrote this one as a generator that yields Tuples of (Node, int) 
each iteration. As you can see, we can easily create a dict from this 
afterwards so the result is similar to the previous function. In both 
cases, the use of traversal functions makes it quite simple and elegant.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">iter_ndescendants</span><span class="p">(</span><span class="n">root_node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Yield tuples of (Node, int) containing n descendants of each Node.&quot;&quot;&quot;</span> 
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">root_node</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="s2">&quot;postorder&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_leaf</span><span class="p">():</span>
            <span class="n">node</span><span class="o">.</span><span class="n">ndesc</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">node</span><span class="o">.</span><span class="n">ndesc</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">ndescendants</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
        <span class="k">yield</span> <span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">ndesc</span><span class="p">)</span>

<span class="c1"># example</span>
<span class="n">root_node</span> <span class="o">=</span> <span class="n">get_random_tree</span><span class="p">(</span><span class="n">ntips</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="nb">dict</span><span class="p">(</span><span class="n">iter_ndescendants</span><span class="p">(</span><span class="n">root_node</span><span class="p">))</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># {Node(left5): 0,</span>
<span class="c1">#  Node(right5): 0,</span>
<span class="c1">#  Node(left3): 2,</span>
<span class="c1">#  Node(left4): 0,</span>
<span class="c1">#  Node(right4): 0,</span>
<span class="c1">#  Node(right3): 2,</span>
<span class="c1">#  Node(left1): 4,</span>
<span class="c1">#  Node(left2): 0,</span>
<span class="c1">#  Node(right2): 0,</span>
<span class="c1">#  Node(right1): 2,</span>
<span class="c1">#  Node(root): 6}</span>
</code></pre></div></p>
<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<ul>
<li>A collection of connected Nodes represents a tree data structure.</li>
<li>Any connected Node can be accessed from another Node. The root Node is 
the most convenient starting point since all other Nodes are descended from it.</li>
<li>Tree traversal algorithms can be used to acccess each Node exactly once in 
a specific order.</li>
<li>Traversals that visit children before parents, or vice-versa, are 
topologically sorted, and can be used to build functions for calculating 
information on a tree. </li>
<li>Generator functions return an iterable by using the <code class="highlight"><span class="k">yield</span></code> 
expression, and are a powerful tool for writing tree traversal and other 
functions.</li>
</ul>
<h3 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h3>
<ul>
<li>https://www.techiedelight.com/postorder-tree-traversal-iterative-recursive/</li>
<li>https://en.wikipedia.org/wiki/Tree_traversal#Breadth-first_search</li>
</ul>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "search.highlight", "search.suggest", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.6df46069.min.js"></script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>